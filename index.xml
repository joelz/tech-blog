<?xml-stylesheet href="/rss.xsl" type="text/xsl"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Notes by Joel</title><link>https://joelz.github.io/tech-blog/</link><description>Recent content on Notes by Joel</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>Copy, right? 🤔</copyright><lastBuildDate>Fri, 03 Nov 2023 12:01:58 +0800</lastBuildDate><atom:link href="https://joelz.github.io/tech-blog/index.xml" rel="self" type="application/rss+xml"/><item><title>读书笔记：OReilly.TypeScript.Cookbook.2023.8.epub</title><link>https://joelz.github.io/tech-blog/posts/20231103-typescript_cookbook_2023_book_notes/</link><pubDate>Fri, 03 Nov 2023 12:01:58 +0800</pubDate><guid>https://joelz.github.io/tech-blog/posts/20231103-typescript_cookbook_2023_book_notes/</guid><description>Notes by Joel https://joelz.github.io/tech-blog/posts/20231103-typescript_cookbook_2023_book_notes/ -&lt;h2 id="48-using-thistype-to-define-this-in-objects">4.8 Using ThisType to Define this in Objects&lt;/h2>
&lt;p>&lt;strong>Problem:&lt;/strong> Your app requires complex configuration objects with methods, where this has a different context depending on usage.&lt;/p>
&lt;p>&lt;strong>Solution:&lt;/strong> Use the built-in generic &lt;code>ThisType&amp;lt;T&amp;gt;&lt;/code> to define the correct this.&lt;/p>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">17
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">18
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">19
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">20
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">21
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">22
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">23
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">24
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">25
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">26
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">27
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">28
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">29
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">30
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">31
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">32
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">33
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">34
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">35
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">36
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">37
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">38
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-typescript" data-lang="typescript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">// An object of functions ...
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span>&lt;span style="color:#c678dd">type&lt;/span> &lt;span style="color:#c1abea">FnObj&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c1abea">Record&lt;/span>&amp;lt;&lt;span style="color:#e06c75">string&lt;/span>, () =&amp;gt; &lt;span style="color:#ef8383">any&lt;/span>&lt;span style="color:#c7bf54">&amp;gt;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">// ... to an object of return types
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span>&lt;span style="color:#c678dd">type&lt;/span> &lt;span style="color:#c1abea">MapFnToProp&lt;/span>&amp;lt;&lt;span style="color:#e06c75">FunctionObj&lt;/span> &lt;span style="color:#b3d23c">extends&lt;/span> &lt;span style="color:#b3d23c">FnObj&lt;/span>&amp;gt; &lt;span style="color:#c7bf54">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> [&lt;span style="color:#c1abea">K&lt;/span> &lt;span style="color:#c678dd">in&lt;/span> &lt;span style="color:#c678dd">keyof&lt;/span> &lt;span style="color:#c1abea">FunctionObj&lt;/span>]&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">ReturnType&lt;/span>&amp;lt;&lt;span style="color:#e06c75">FunctionObj&lt;/span>[&lt;span style="color:#b3d23c">K&lt;/span>]&amp;gt;;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">type&lt;/span> &lt;span style="color:#c1abea">Options&lt;/span>&amp;lt;&lt;span style="color:#e06c75">Data&lt;/span>, &lt;span style="color:#b3d23c">Computed&lt;/span> &lt;span style="color:#b3d23c">extends&lt;/span> &lt;span style="color:#b3d23c">FnObj&lt;/span>, &lt;span style="color:#b3d23c">Methods&lt;/span>&amp;gt; &lt;span style="color:#c7bf54">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">data&lt;/span>(&lt;span style="color:#c678dd">this&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> {})&lt;span style="color:#c7bf54">?:&lt;/span> &lt;span style="color:#c1abea">Data&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">computed?&lt;/span>: &lt;span style="color:#ef8383">Computed&lt;/span> &lt;span style="color:#c7bf54">&amp;amp;&lt;/span> &lt;span style="color:#c1abea">ThisType&lt;/span>&amp;lt;&lt;span style="color:#e06c75">Data&lt;/span>&amp;gt;;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">methods?&lt;/span>: &lt;span style="color:#ef8383">Methods&lt;/span> &lt;span style="color:#c7bf54">&amp;amp;&lt;/span> &lt;span style="color:#c1abea">ThisType&lt;/span>&amp;lt;&lt;span style="color:#e06c75">Data&lt;/span> &amp;amp; &lt;span style="color:#b3d23c">MapFnToProp&lt;/span>&amp;lt;&lt;span style="color:#b3d23c">Computed&lt;/span>&amp;gt; &lt;span style="color:#c7bf54">&amp;amp;&lt;/span> &lt;span style="color:#c1abea">Methods&lt;/span>&lt;span style="color:#c7bf54">&amp;gt;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">declare&lt;/span> &lt;span style="color:#c678dd">function&lt;/span> &lt;span style="color:#c1abea">create&lt;/span>&amp;lt;&lt;span style="color:#e06c75">Data&lt;/span>, &lt;span style="color:#b3d23c">Computed&lt;/span> &lt;span style="color:#b3d23c">extends&lt;/span> &lt;span style="color:#b3d23c">FnObj&lt;/span>, &lt;span style="color:#b3d23c">Methods&lt;/span>&amp;gt;(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">options&lt;/span>: &lt;span style="color:#ef8383">Options&lt;/span>&amp;lt;&lt;span style="color:#e06c75">Data&lt;/span>, &lt;span style="color:#b3d23c">Computed&lt;/span>, &lt;span style="color:#b3d23c">Methods&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>)&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#ef8383">any&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">// use the types
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span>&lt;span style="color:#c678dd">const&lt;/span> &lt;span style="color:#c1abea">instance&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c1abea">create&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">data() {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">return&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">firstName&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#63c381">&amp;#34;Stefan&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">lastName&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#63c381">&amp;#34;Baumgartner&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">computed&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">fullName() {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">// has access to the return object of data
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c678dd">return&lt;/span> &lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">firstName&lt;/span> &lt;span style="color:#c7bf54">+&lt;/span> &lt;span style="color:#63c381">&amp;#34; &amp;#34;&lt;/span> &lt;span style="color:#c7bf54">+&lt;/span> &lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">lastName&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">methods&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">hi() {&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">// use computed properties just like normal properties
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c1abea">alert&lt;/span>(&lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">fullName&lt;/span>.&lt;span style="color:#c1abea">toLowerCase&lt;/span>());
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>});
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="65-dealing-with-recursion-limits">6.5 Dealing with Recursion Limits&lt;/h2>
&lt;p>We want to use TypeScript’s feature to recursively call conditional types to create a valid string identifier out of any string, by removing whitespace and invalid
characters.&lt;/p>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">17
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">18
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">19
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">20
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">21
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">22
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">23
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">24
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">25
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">26
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">27
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">28
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-typescript" data-lang="typescript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">type&lt;/span> &lt;span style="color:#c1abea">RemoveWhiteSpace&lt;/span>&amp;lt;&lt;span style="color:#e06c75">T&lt;/span> &lt;span style="color:#b3d23c">extends&lt;/span> &lt;span style="color:#b3d23c">string&lt;/span>&amp;gt; &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c1abea">T&lt;/span> &lt;span style="color:#c678dd">extends&lt;/span> &lt;span style="color:#98c379">`&lt;/span>&lt;span style="color:#98c379">${&lt;/span>&lt;span style="color:#c678dd">infer&lt;/span> &lt;span style="color:#c1abea">A&lt;/span>&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379"> &lt;/span>&lt;span style="color:#98c379">${&lt;/span>&lt;span style="color:#c678dd">infer&lt;/span> &lt;span style="color:#c1abea">B&lt;/span>&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379">`&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c7bf54">?&lt;/span> &lt;span style="color:#c1abea">RemoveWhiteSpace&lt;/span>&lt;span style="color:#c7bf54">&amp;lt;&lt;/span>&lt;span style="color:#98c379">`&lt;/span>&lt;span style="color:#98c379">${&lt;/span>&lt;span style="color:#c1abea">Uncapitalize&lt;/span>&amp;lt;&lt;span style="color:#e06c75">A&lt;/span>&amp;gt;&lt;span style="color:#98c379">}${&lt;/span>&lt;span style="color:#c1abea">Capitalize&lt;/span>&amp;lt;&lt;span style="color:#e06c75">B&lt;/span>&amp;gt;&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379">`&lt;/span>&lt;span style="color:#c7bf54">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">T&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">type&lt;/span> &lt;span style="color:#c1abea">Identifier&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c1abea">RemoveWhiteSpace&lt;/span>&lt;span style="color:#c7bf54">&amp;lt;&lt;/span>&lt;span style="color:#63c381">&amp;#34;Hello World!&amp;#34;&lt;/span>&lt;span style="color:#c7bf54">&amp;gt;&lt;/span>; &lt;span style="color:#8a93a5;font-style:italic">// &amp;#34;helloWorld!”
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">type&lt;/span> &lt;span style="color:#c1abea">StringSplit&lt;/span>&amp;lt;&lt;span style="color:#e06c75">T&lt;/span> &lt;span style="color:#b3d23c">extends&lt;/span> &lt;span style="color:#b3d23c">string&lt;/span>&amp;gt; &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c1abea">T&lt;/span> &lt;span style="color:#c678dd">extends&lt;/span> &lt;span style="color:#98c379">`&lt;/span>&lt;span style="color:#98c379">${&lt;/span>&lt;span style="color:#c678dd">infer&lt;/span> &lt;span style="color:#c1abea">Char&lt;/span>&lt;span style="color:#98c379">}${&lt;/span>&lt;span style="color:#c678dd">infer&lt;/span> &lt;span style="color:#c1abea">Rest&lt;/span>&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379">`&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c7bf54">?&lt;/span> &lt;span style="color:#c1abea">Capitalize&lt;/span>&amp;lt;&lt;span style="color:#e06c75">Char&lt;/span>&amp;gt; &lt;span style="color:#c7bf54">|&lt;/span> &lt;span style="color:#c1abea">Uncapitalize&lt;/span>&amp;lt;&lt;span style="color:#e06c75">Char&lt;/span>&amp;gt; &lt;span style="color:#c7bf54">|&lt;/span> &lt;span style="color:#c1abea">StringSplit&lt;/span>&amp;lt;&lt;span style="color:#e06c75">Rest&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#ef8383">never&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">type&lt;/span> &lt;span style="color:#c1abea">Chars&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c1abea">StringSplit&lt;/span>&lt;span style="color:#c7bf54">&amp;lt;&lt;/span>&lt;span style="color:#63c381">&amp;#34;abcdefghijklmnopqrstuvwxyz&amp;#34;&lt;/span>&lt;span style="color:#c7bf54">&amp;gt;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">// &amp;#34;a&amp;#34; | &amp;#34;A&amp;#34; | &amp;#34;b&amp;#34; | &amp;#34;B&amp;#34; | &amp;#34;c&amp;#34; | &amp;#34;C&amp;#34; | &amp;#34;d&amp;#34; | &amp;#34;D&amp;#34; | &amp;#34;e&amp;#34; | &amp;#34;E&amp;#34; |
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">// &amp;#34;f&amp;#34; | &amp;#34;F&amp;#34; | &amp;#34;g&amp;#34; | &amp;#34;G&amp;#34; | &amp;#34;h&amp;#34; | &amp;#34;H&amp;#34; | &amp;#34;i&amp;#34; | ...
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">type&lt;/span> &lt;span style="color:#c1abea">CreateIdentifier&lt;/span>&amp;lt;&lt;span style="color:#e06c75">T&lt;/span> &lt;span style="color:#b3d23c">extends&lt;/span> &lt;span style="color:#b3d23c">string&lt;/span>&amp;gt; &lt;span style="color:#c7bf54">=&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">RemoveWhiteSpace&lt;/span>&amp;lt;&lt;span style="color:#e06c75">T&lt;/span>&amp;gt; &lt;span style="color:#c678dd">extends&lt;/span> &lt;span style="color:#98c379">`&lt;/span>&lt;span style="color:#98c379">${&lt;/span>&lt;span style="color:#c678dd">infer&lt;/span> &lt;span style="color:#c1abea">A&lt;/span> &lt;span style="color:#c678dd">extends&lt;/span> &lt;span style="color:#c1abea">Chars&lt;/span>&lt;span style="color:#98c379">}${&lt;/span>&lt;span style="color:#c678dd">infer&lt;/span> &lt;span style="color:#c1abea">Rest&lt;/span>&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379">`&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c7bf54">?&lt;/span> &lt;span style="color:#98c379">`&lt;/span>&lt;span style="color:#98c379">${&lt;/span>&lt;span style="color:#c1abea">A&lt;/span>&lt;span style="color:#98c379">}${&lt;/span>&lt;span style="color:#c1abea">CreateIdentifier&lt;/span>&amp;lt;&lt;span style="color:#e06c75">Rest&lt;/span>&amp;gt;&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379">`&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">// ^ Type instantiation is excessively deep and possibly infinite.(2589)_.
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">RemoveWhiteSpace&lt;/span>&amp;lt;&lt;span style="color:#e06c75">T&lt;/span>&amp;gt; &lt;span style="color:#c678dd">extends&lt;/span> &lt;span style="color:#98c379">`&lt;/span>&lt;span style="color:#98c379">${&lt;/span>&lt;span style="color:#c678dd">infer&lt;/span> &lt;span style="color:#c1abea">A&lt;/span>&lt;span style="color:#98c379">}${&lt;/span>&lt;span style="color:#c678dd">infer&lt;/span> &lt;span style="color:#c1abea">Rest&lt;/span>&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379">`&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c7bf54">?&lt;/span> &lt;span style="color:#c1abea">CreateIdentifier&lt;/span>&amp;lt;&lt;span style="color:#e06c75">Rest&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">T&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">type&lt;/span> &lt;span style="color:#c1abea">CreateIdentifier&lt;/span>&amp;lt;&lt;span style="color:#e06c75">T&lt;/span> &lt;span style="color:#b3d23c">extends&lt;/span> &lt;span style="color:#b3d23c">string&lt;/span>, &lt;span style="color:#b3d23c">Acc&lt;/span> &lt;span style="color:#b3d23c">extends&lt;/span> &lt;span style="color:#b3d23c">string &lt;/span>&lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#98c379">&amp;#34;&amp;#34;&lt;/span>&amp;gt; &lt;span style="color:#c7bf54">=&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">RemoveWhiteSpace&lt;/span>&amp;lt;&lt;span style="color:#e06c75">T&lt;/span>&amp;gt; &lt;span style="color:#c678dd">extends&lt;/span> &lt;span style="color:#98c379">`&lt;/span>&lt;span style="color:#98c379">${&lt;/span>&lt;span style="color:#c678dd">infer&lt;/span> &lt;span style="color:#c1abea">A&lt;/span> &lt;span style="color:#c678dd">extends&lt;/span> &lt;span style="color:#c1abea">Chars&lt;/span>&lt;span style="color:#98c379">}${&lt;/span>&lt;span style="color:#c678dd">infer&lt;/span> &lt;span style="color:#c1abea">Rest&lt;/span>&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379">`&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c7bf54">?&lt;/span> &lt;span style="color:#c1abea">CreateIdentifier&lt;/span>&amp;lt;&lt;span style="color:#e06c75">Rest&lt;/span>, `${&lt;span style="color:#b3d23c">Acc&lt;/span>}${&lt;span style="color:#b3d23c">A&lt;/span>}`&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">RemoveWhiteSpace&lt;/span>&amp;lt;&lt;span style="color:#e06c75">T&lt;/span>&amp;gt; &lt;span style="color:#c678dd">extends&lt;/span> &lt;span style="color:#98c379">`&lt;/span>&lt;span style="color:#98c379">${&lt;/span>&lt;span style="color:#c678dd">infer&lt;/span> &lt;span style="color:#c1abea">A&lt;/span>&lt;span style="color:#98c379">}${&lt;/span>&lt;span style="color:#c678dd">infer&lt;/span> &lt;span style="color:#c1abea">Rest&lt;/span>&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379">`&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c7bf54">?&lt;/span> &lt;span style="color:#c1abea">CreateIdentifier&lt;/span>&amp;lt;&lt;span style="color:#e06c75">Rest&lt;/span>, &lt;span style="color:#b3d23c">Acc&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">Acc&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">type&lt;/span> &lt;span style="color:#c1abea">Identifier&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c1abea">CreateIdentifier&lt;/span>&lt;span style="color:#c7bf54">&amp;lt;&lt;/span>&lt;span style="color:#63c381">&amp;#34;Hello Wor!ld!&amp;#34;&lt;/span>&lt;span style="color:#c7bf54">&amp;gt;&lt;/span>; &lt;span style="color:#8a93a5;font-style:italic">// &amp;#34;helloWorld&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="72-typing-a-promisify-function">7.2 Typing a promisify Function&lt;/h2>
&lt;p>&lt;strong>Problem:&lt;/strong> You want to convert callback-style functions to Promises and have them perfectly typed.&lt;/p>
&lt;p>&lt;strong>Solution:&lt;/strong> Function arguments are tuple types. Make them generic using variadic tuple types.&lt;/p>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-typescript" data-lang="typescript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">function&lt;/span> &lt;span style="color:#c1abea">promisify&lt;/span>&amp;lt;&lt;span style="color:#e06c75">Args&lt;/span> &lt;span style="color:#b3d23c">extends&lt;/span> &lt;span style="color:#b3d23c">unknown&lt;/span>[], &lt;span style="color:#b3d23c">Res&lt;/span>&amp;gt;(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">fn&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> (...&lt;span style="color:#c1abea">args&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> [...&lt;span style="color:#c1abea">Args&lt;/span>, (&lt;span style="color:#c1abea">result&lt;/span>: &lt;span style="color:#ef8383">Res&lt;/span>) &lt;span style="color:#c7bf54">=&amp;gt;&lt;/span> &lt;span style="color:#c678dd">void&lt;/span>]) &lt;span style="color:#c7bf54">=&amp;gt;&lt;/span> &lt;span style="color:#c678dd">void&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>)&lt;span style="color:#c7bf54">:&lt;/span> (...&lt;span style="color:#c1abea">args&lt;/span>: &lt;span style="color:#ef8383">Args&lt;/span>) &lt;span style="color:#c7bf54">=&amp;gt;&lt;/span> &lt;span style="color:#c1abea">Promise&lt;/span>&amp;lt;&lt;span style="color:#e06c75">Res&lt;/span>&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">return&lt;/span> &lt;span style="color:#c678dd">function&lt;/span> (...&lt;span style="color:#c1abea">args&lt;/span>: &lt;span style="color:#ef8383">Args&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">return&lt;/span> &lt;span style="color:#c678dd">new&lt;/span> &lt;span style="color:#c1abea">Promise&lt;/span>((&lt;span style="color:#c1abea">resolve&lt;/span>) &lt;span style="color:#c7bf54">=&amp;gt;&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">function&lt;/span> &lt;span style="color:#c1abea">callback&lt;/span>(&lt;span style="color:#c1abea">res&lt;/span>: &lt;span style="color:#ef8383">Res&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">resolve&lt;/span>(&lt;span style="color:#c1abea">res&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">fn&lt;/span>.&lt;span style="color:#c1abea">call&lt;/span>(&lt;span style="color:#b756ff;font-weight:bold">null&lt;/span>, ...[...&lt;span style="color:#c1abea">args&lt;/span>, &lt;span style="color:#c1abea">callback&lt;/span>]);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="83-remapping-types">8.3 Remapping Types&lt;/h2>
&lt;p>&lt;strong>Problem:&lt;/strong> Constructing types gives you flexible, self-maintaining types, but the editor hints leave a lot to be desired.&lt;/p>
&lt;p>&lt;strong>Solution:&lt;/strong> Use the Remap&lt;!-- raw HTML omitted --> and DeepRemap&lt;!-- raw HTML omitted --> helper types to improve editor hints.&lt;/p>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-typescript" data-lang="typescript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">type&lt;/span> &lt;span style="color:#c1abea">Remap&lt;/span>&amp;lt;&lt;span style="color:#e06c75">T&lt;/span>&amp;gt; &lt;span style="color:#c7bf54">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> [&lt;span style="color:#c1abea">K&lt;/span> &lt;span style="color:#c678dd">in&lt;/span> &lt;span style="color:#c678dd">keyof&lt;/span> &lt;span style="color:#c1abea">T&lt;/span>]&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">T&lt;/span>[&lt;span style="color:#c1abea">K&lt;/span>];
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>};
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">type&lt;/span> &lt;span style="color:#c1abea">DeepRemap&lt;/span>&amp;lt;&lt;span style="color:#e06c75">T&lt;/span>&amp;gt; &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c1abea">T&lt;/span> &lt;span style="color:#c678dd">extends&lt;/span> &lt;span style="color:#ef8383">object&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c7bf54">?&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> [&lt;span style="color:#c1abea">K&lt;/span> &lt;span style="color:#c678dd">in&lt;/span> &lt;span style="color:#c678dd">keyof&lt;/span> &lt;span style="color:#c1abea">T&lt;/span>]&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">DeepRemap&lt;/span>&amp;lt;&lt;span style="color:#e06c75">T&lt;/span>[&lt;span style="color:#b3d23c">K&lt;/span>]&amp;gt;;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">T&lt;/span>;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="127-deciding-whether-to-use-function-overloads-or-conditional-types">12.7 Deciding Whether to Use Function Overloads or Conditional Types&lt;/h2>
&lt;p>Function overloads provide better readability and an easier way to define expectations from your type than conditionals. Use them when the situation requires.&lt;/p>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">17
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">18
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">19
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">20
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">21
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">22
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">23
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">24
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">25
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-typescript" data-lang="typescript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">// Function overloads
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span>&lt;span style="color:#c678dd">function&lt;/span> &lt;span style="color:#c1abea">fetchOrder&lt;/span>(&lt;span style="color:#c1abea">customer&lt;/span>: &lt;span style="color:#ef8383">Customer&lt;/span>)&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">Order&lt;/span>[]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">function&lt;/span> &lt;span style="color:#c1abea">fetchOrder&lt;/span>(&lt;span style="color:#c1abea">product&lt;/span>: &lt;span style="color:#ef8383">Product&lt;/span>)&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">Order&lt;/span>[]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">function&lt;/span> &lt;span style="color:#c1abea">fetchOrder&lt;/span>(&lt;span style="color:#c1abea">orderId&lt;/span>: &lt;span style="color:#ef8383">number&lt;/span>)&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">Order&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">function&lt;/span> &lt;span style="color:#c1abea">fetchOrder&lt;/span>(&lt;span style="color:#c1abea">param&lt;/span>: &lt;span style="color:#ef8383">Customer&lt;/span> &lt;span style="color:#c7bf54">|&lt;/span> &lt;span style="color:#c1abea">Product&lt;/span>)&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">Order&lt;/span>[]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">function&lt;/span> &lt;span style="color:#c1abea">fetchOrder&lt;/span>(&lt;span style="color:#c1abea">param&lt;/span>: &lt;span style="color:#ef8383">Customer&lt;/span> &lt;span style="color:#c7bf54">|&lt;/span> &lt;span style="color:#ef8383">number&lt;/span>)&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">Order&lt;/span> &lt;span style="color:#c7bf54">|&lt;/span> &lt;span style="color:#c1abea">Order&lt;/span>[]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">function&lt;/span> &lt;span style="color:#c1abea">fetchOrder&lt;/span>(&lt;span style="color:#c1abea">param&lt;/span>: &lt;span style="color:#ef8383">number&lt;/span> &lt;span style="color:#c7bf54">|&lt;/span> &lt;span style="color:#c1abea">Product&lt;/span>)&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">Order&lt;/span> &lt;span style="color:#c7bf54">|&lt;/span> &lt;span style="color:#c1abea">Order&lt;/span>[]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">// the implementation
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span>&lt;span style="color:#c678dd">function&lt;/span> &lt;span style="color:#c1abea">fetchOrder&lt;/span>(&lt;span style="color:#c1abea">param&lt;/span>: &lt;span style="color:#ef8383">any&lt;/span>)&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">Order&lt;/span> &lt;span style="color:#c7bf54">|&lt;/span> &lt;span style="color:#c1abea">Order&lt;/span>[] {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">//...
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">// Here, conditional types can reduce your function signature tremendously:
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span>&lt;span style="color:#c678dd">type&lt;/span> &lt;span style="color:#c1abea">FetchParams&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#ef8383">number&lt;/span> &lt;span style="color:#c7bf54">|&lt;/span> &lt;span style="color:#c1abea">Customer&lt;/span> &lt;span style="color:#c7bf54">|&lt;/span> &lt;span style="color:#c1abea">Product&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">type&lt;/span> &lt;span style="color:#c1abea">FetchReturn&lt;/span>&amp;lt;&lt;span style="color:#e06c75">T&lt;/span>&amp;gt; &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c1abea">T&lt;/span> &lt;span style="color:#c678dd">extends&lt;/span> &lt;span style="color:#c1abea">Customer&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c7bf54">?&lt;/span> &lt;span style="color:#c1abea">Order&lt;/span>[]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">T&lt;/span> &lt;span style="color:#c678dd">extends&lt;/span> &lt;span style="color:#c1abea">Product&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c7bf54">?&lt;/span> &lt;span style="color:#c1abea">Order&lt;/span>[]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">T&lt;/span> &lt;span style="color:#c678dd">extends&lt;/span> &lt;span style="color:#ef8383">number&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c7bf54">?&lt;/span> &lt;span style="color:#c1abea">Order&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> : &lt;span style="color:#ef8383">never&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">function&lt;/span> &lt;span style="color:#c1abea">fetchOrder&lt;/span>&amp;lt;&lt;span style="color:#e06c75">T&lt;/span> &lt;span style="color:#b3d23c">extends&lt;/span> &lt;span style="color:#b3d23c">FetchParams&lt;/span>&amp;gt;(&lt;span style="color:#c1abea">params&lt;/span>: &lt;span style="color:#ef8383">T&lt;/span>)&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">FetchReturn&lt;/span>&amp;lt;&lt;span style="color:#e06c75">T&lt;/span>&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">//...
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>One scenario where function overloads remain handy is if you have different argument lists for your function variants. This means not only the arguments (parameters) themselves can have some variety (this is where conditionals and variadic tuples are fantastic) but also the number and position of arguments.&lt;/p>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-typescript" data-lang="typescript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">function&lt;/span> &lt;span style="color:#c1abea">search&lt;/span>(&lt;span style="color:#c1abea">query&lt;/span>: &lt;span style="color:#ef8383">string&lt;/span>)&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">Promise&lt;/span>&amp;lt;&lt;span style="color:#e06c75">unknown&lt;/span>[]&amp;gt;;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">function&lt;/span> &lt;span style="color:#c1abea">search&lt;/span>(&lt;span style="color:#c1abea">query&lt;/span>: &lt;span style="color:#ef8383">string&lt;/span>, &lt;span style="color:#c1abea">callback&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> (&lt;span style="color:#c1abea">result&lt;/span>: &lt;span style="color:#ef8383">unknown&lt;/span>[]) &lt;span style="color:#c7bf54">=&amp;gt;&lt;/span> &lt;span style="color:#c678dd">void&lt;/span>)&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c678dd">void&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">// This is the implementation, it only concerns you
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span>&lt;span style="color:#c678dd">function&lt;/span> &lt;span style="color:#c1abea">search&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">query&lt;/span>: &lt;span style="color:#ef8383">string&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">callback&lt;/span>&lt;span style="color:#c7bf54">?:&lt;/span> (&lt;span style="color:#c1abea">result&lt;/span>: &lt;span style="color:#ef8383">unknown&lt;/span>[]) &lt;span style="color:#c7bf54">=&amp;gt;&lt;/span> &lt;span style="color:#c678dd">void&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>)&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c678dd">void&lt;/span> &lt;span style="color:#c7bf54">|&lt;/span> &lt;span style="color:#c1abea">Promise&lt;/span>&amp;lt;&lt;span style="color:#e06c75">unknown&lt;/span>&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">// Implement
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>Another situation where function overloads can make things easier is when you need exact arguments and their mapping.”&lt;/p>
- https://joelz.github.io/tech-blog/posts/20231103-typescript_cookbook_2023_book_notes/ - Copy, right? 🤔</description></item><item><title>短信链接拉起 app 方案</title><link>https://joelz.github.io/tech-blog/posts/20230815-android_app_links/</link><pubDate>Tue, 15 Aug 2023 12:01:58 +0800</pubDate><guid>https://joelz.github.io/tech-blog/posts/20230815-android_app_links/</guid><description>Notes by Joel https://joelz.github.io/tech-blog/posts/20230815-android_app_links/ -&lt;h2 id="需求">需求&lt;/h2>
&lt;p>短信链接拉起app，去到app的某个特定页面。&lt;/p>
&lt;h2 id="结论">结论&lt;/h2>
&lt;p>iOS 上采用 Universal Links，Android 上采用 URL Scheme(非https/http)。落地页统一使用 Universal Links 指向的 app 下载页。如果考虑到用户可能没有安装 app，那 &lt;a href="https://www.kerryplus.com/ulink/">https://www.kerryplus.com/ulink/&lt;/a> 需要返回页面（一般就是一个app下载页），这个页面上再执行 android 端的 url scheme 拉起app，类似这样的代码：&lt;/p>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">17
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">/**
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic"> * 检查是否从短信中需拉起app的链接进入，如果是，且在 Anroid 上，则尝试拉起 app
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic"> */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">function&lt;/span> &lt;span style="color:#c1abea">checkAppDeepLink&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">const&lt;/span> &lt;span style="color:#c1abea">platform&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c1abea">getMobileOperatingSystem&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">const&lt;/span> &lt;span style="color:#c1abea">href&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c1abea">location&lt;/span>.&lt;span style="color:#c1abea">href&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">const&lt;/span> &lt;span style="color:#c1abea">index&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c1abea">href&lt;/span>.&lt;span style="color:#c1abea">indexOf&lt;/span>(&lt;span style="color:#98c379">&amp;#39;/ulink/&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">if&lt;/span> (&lt;span style="color:#c1abea">index&lt;/span> &lt;span style="color:#c7bf54">&amp;gt;&lt;/span> &lt;span style="color:#c7bf54">-&lt;/span>&lt;span style="color:#d19a66">1&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">const&lt;/span> &lt;span style="color:#c1abea">param&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c1abea">href&lt;/span>.&lt;span style="color:#c1abea">substring&lt;/span>(&lt;span style="color:#c1abea">index&lt;/span> &lt;span style="color:#c7bf54">+&lt;/span> &lt;span style="color:#d19a66">7&lt;/span>);&lt;span style="color:#8a93a5;font-style:italic">// 7 就是 &amp;#39;/ulink/&amp;#39;.length
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">// iOS 上面进入页面时 Universal Links 就已经打开 app了
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">// 所以这里只用处理 Android
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c678dd">if&lt;/span> (&lt;span style="color:#c1abea">platform&lt;/span> &lt;span style="color:#c7bf54">==&lt;/span> &lt;span style="color:#63c381">&amp;#34;Android&amp;#34;&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">location&lt;/span>.&lt;span style="color:#c1abea">href&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#63c381">&amp;#34;kerryplusenterprise://ulink/&amp;#34;&lt;/span> &lt;span style="color:#c7bf54">+&lt;/span> &lt;span style="color:#c1abea">param&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="ios-测试结果">iOS 测试结果&lt;/h2>
&lt;p>方案：Universal Links&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>默认浏览器&lt;/th>
&lt;th>短信中用直链&lt;/th>
&lt;th>短信中用短链接&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Safari&lt;/td>
&lt;td>直接拉起 app，参数正确&lt;/td>
&lt;td>先跳转到 Safari，然后再拉起 app，参数正确&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>Chrome&lt;/td>
&lt;td>直接拉起 app，参数正确&lt;/td>
&lt;td>先去到 Chrome，然后 404 了&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;p>直链测试短信：Hello，这是跳转到 ios app 的链接：https://www.kerryplus.com/ulink/?a=1，点击可以打开C端App。&lt;/p>
&lt;p>短链测试短信：Hello，这是跳转到 ios app 的短链接：sh7x.cn/3000CNF，点击可以打开C端App。&lt;/p>
&lt;p>方案 Url Scheme：&lt;/p>
&lt;p>Safari 和 Chrome 都可以，拉起前会有询问（iOS上短信链接拉起小程序用的就是 universal links + url scheme 拉起微信）。但是如果用户没有装 app，会有一个「打不开网页，因为网址无效」的弹窗。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://community.jiguang.cn/article/464296">iOS 深度跳转（scheme、universal link）-极光社区&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://community.jiguang.cn/article/464337">深度跳转-scheme-极光社区&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://zhuanlan.zhihu.com/p/444908355">趣谈 iOS Universal Link - 知乎&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>** Chrome+短链接 404 的原因是因为目标链接本身就是一个不存的地址，需要 nginx 做一下转发，返回app下载页 **&lt;/p>
&lt;h2 id="android-测试结果">Android 测试结果&lt;/h2>
&lt;p>方案：URL Scheme 和 App Links&lt;/p>
&lt;p>&lt;strong>注意：URL Scheme 不能有大写字母！！&lt;/strong>&lt;/p>
&lt;p>&lt;strong>注意：intent-filter 要加到 android.intent.category.LAUNCHER 那个 activity 里面！！&lt;/strong>&lt;/p>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">17
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">18
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">19
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">20
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">21
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">22
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-xml" data-lang="xml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&amp;lt;!-- 方案1: URLScheme - https/http --&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">&amp;lt;!-- &amp;lt;intent-filter&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic"> &amp;lt;category android:name=&amp;#34;android.intent.category.DEFAULT&amp;#34; /&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic"> &amp;lt;category android:name=&amp;#34;android.intent.category.BROWSABLE&amp;#34; /&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic"> &amp;lt;action android:name=&amp;#34;android.intent.action.VIEW&amp;#34; /&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic"> &amp;lt;data android:scheme=&amp;#34;http&amp;#34; android:host=&amp;#34;app-links.dc1979.com&amp;#34; android:pathPattern=&amp;#34;.*&amp;#34;/&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic"> &amp;lt;data android:scheme=&amp;#34;https&amp;#34; android:host=&amp;#34;app-links.dc1979.com&amp;#34; android:pathPattern=&amp;#34;.*&amp;#34;/&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic"> &amp;lt;/intent-filter&amp;gt; --&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">&amp;lt;!-- 方案2: URLScheme - 非https/http --&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">&amp;lt;intent-filter&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">&amp;lt;category&lt;/span> &lt;span style="color:#b3d23c">android:name=&lt;/span>&lt;span style="color:#98c379">&amp;#34;android.intent.category.DEFAULT&amp;#34;&lt;/span> &lt;span style="color:#e06c75">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">&amp;lt;category&lt;/span> &lt;span style="color:#b3d23c">android:name=&lt;/span>&lt;span style="color:#98c379">&amp;#34;android.intent.category.BROWSABLE&amp;#34;&lt;/span> &lt;span style="color:#e06c75">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">&amp;lt;action&lt;/span> &lt;span style="color:#b3d23c">android:name=&lt;/span>&lt;span style="color:#98c379">&amp;#34;android.intent.action.VIEW&amp;#34;&lt;/span> &lt;span style="color:#e06c75">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">&amp;lt;data&lt;/span> &lt;span style="color:#b3d23c">android:scheme=&lt;/span>&lt;span style="color:#98c379">&amp;#34;h56131bcc&amp;#34;&lt;/span> &lt;span style="color:#e06c75">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">&amp;lt;/intent-filter&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">&amp;lt;!-- 方案3: App Links --&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">&amp;lt;!-- &amp;lt;intent-filter android:autoVerify=&amp;#34;true&amp;#34;&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic"> &amp;lt;category android:name=&amp;#34;android.intent.category.DEFAULT&amp;#34; /&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic"> &amp;lt;category android:name=&amp;#34;android.intent.category.BROWSABLE&amp;#34; /&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic"> &amp;lt;action android:name=&amp;#34;android.intent.action.VIEW&amp;#34; /&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic"> &amp;lt;data android:scheme=&amp;#34;https&amp;#34; android:host=&amp;#34;app-links.dc1979.com&amp;#34; android:pathPrefix=&amp;#34;/ulink&amp;#34; /&amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic"> &amp;lt;/intent-filter&amp;gt; --&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;table>
&lt;thead>
&lt;tr>
&lt;th>&lt;/th>
&lt;th>测试1&lt;/th>
&lt;th>测试 2&lt;/th>
&lt;th>测试 3&lt;/th>
&lt;th>测试 4&lt;/th>
&lt;th>测试 5&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>方案&lt;/td>
&lt;td>URLScheme(https/http) + 直链&lt;/td>
&lt;td>URLScheme(https/http) + 短链&lt;/td>
&lt;td>URLScheme(非https/http) + 短链&lt;/td>
&lt;td>App Links + 直链&lt;/td>
&lt;td>App Links + 短链&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>使用的 apk&lt;/td>
&lt;td>KerryPlus-3521-20230822.1434.apk&lt;/td>
&lt;td>同测试1&lt;/td>
&lt;td>KerryPlus-DEV-3531-20230822.1439.apk&lt;/td>
&lt;td>KerryPlus-DEV-3541-20230822.1442.apk&lt;/td>
&lt;td>同测试4&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>短信内容&lt;/td>
&lt;td>Hello，这是跳转到 android app 的链接：https://app-links.dc1979.com/ulink/?a=1，点击可以打开C端App。&lt;/td>
&lt;td>Hello，这是跳转到 android app 的短链接：sh7x.cn/3000Fyl，点击可以打开C端App。&lt;/td>
&lt;td>Hello，这是跳转到 android app 的短链接：sh7x.cn/3000L48，点击可以打开C端App。&lt;/td>
&lt;td>同测试1的短信内容&lt;/td>
&lt;td>同测试2的短信内容&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>OPPO RENO7, android 13, 手机默浏览器&lt;/td>
&lt;td>浏览器打开链接，app未拉起&lt;/td>
&lt;td>浏览器打开链接，app未拉起&lt;/td>
&lt;td>浏览器打开链接，三秒后弹窗，用户点击打开后app成功拉起，参数正确✅&lt;/td>
&lt;td>浏览器打开链接，app未拉起&lt;/td>
&lt;td>浏览器打开链接，app未拉起&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>VIVO S15 Android 13 手机默认浏览器&lt;/td>
&lt;td>浏览器打开链接,未弹出弹窗，app未拉起&lt;/td>
&lt;td>浏览器打开链接,未弹出弹窗，app未拉起&lt;/td>
&lt;td>浏览器打开链接，需要手动点击 立即跳转，成功跳转至APP，参数正确☑️&lt;/td>
&lt;td>浏览器打开链接，app未拉起&lt;/td>
&lt;td>浏览器打开链接，app未拉起&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>HUAWEI HarmonyOS 3.0.0 手机默认浏览器&lt;/td>
&lt;td>浏览器打开链接,未弹出弹窗，app未拉起&lt;/td>
&lt;td>浏览器打开链接,未弹出弹窗，app未拉起&lt;/td>
&lt;td>浏览器打开链接，需要手动点击 立即跳转，弹出“打开”，点击“打开”，成功跳转至APP，参数正确☑️&lt;/td>
&lt;td>浏览器打开链接，手动点击 立即跳转，未弹出弹窗，app未拉起&lt;/td>
&lt;td>浏览器打开链接,未弹出弹窗，app未拉起&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>XIAOMI 11 MIUI 13.0.9 Android12 手机默认浏览器&lt;/td>
&lt;td>浏览器打开链接,未弹出弹窗，app未拉起&lt;/td>
&lt;td>浏览器打开链接,未弹出弹窗，app未拉起&lt;/td>
&lt;td>浏览器打开链接，三秒后弹窗，用户点击打开后app成功拉起，参数正确✅&lt;/td>
&lt;td>浏览器打开链接,未弹出弹窗，app未拉起&lt;/td>
&lt;td>浏览器打开链接,未弹出弹窗，app未拉起&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ONEPLUS 6, android 10, 手机默认浏览器&lt;/td>
&lt;td>短信界面弹窗，用户选择app打开后，app成功拉起，但是参数不对&lt;/td>
&lt;td>浏览器打开链接，app未拉起&lt;/td>
&lt;td>浏览器打开链接，三秒后弹窗，用户点击打开后app成功拉起，参数正确✅&lt;/td>
&lt;td>短信界面弹窗，用户选择app打开后，app成功拉起，但是参数不对&lt;/td>
&lt;td>浏览器打开链接，app未拉起&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>ONEPLUS 6, android 10, Chrome&lt;/td>
&lt;td>短信界面弹窗，用户选择app打开后，app成功拉起，但是参数不对&lt;/td>
&lt;td>短信界面弹窗，用户选择app打开后，app成功拉起，但是参数不对&lt;/td>
&lt;td>浏览器打开链接，三秒后弹窗，用户点击打开后app成功拉起，参数正确✅&lt;/td>
&lt;td>短信界面弹窗，用户选择app打开后，app成功拉起，但是参数不对&lt;/td>
&lt;td>短信界面弹窗，用户选择app打开后，app成功拉起，但是参数不对&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2 id="uniapp-代码">uniapp 代码&lt;/h2>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">// onShow in App.vue
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span>&lt;span style="color:#c678dd">try&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">const&lt;/span> &lt;span style="color:#c1abea">obj&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> { &lt;span style="color:#c1abea">args&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">plus&lt;/span>.&lt;span style="color:#c1abea">runtime&lt;/span>.&lt;span style="color:#c1abea">arguments&lt;/span>, &lt;span style="color:#98c379">&amp;#39;来源&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">plus&lt;/span>.&lt;span style="color:#c1abea">runtime&lt;/span>.&lt;span style="color:#c1abea">launcher&lt;/span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">// ios: {&amp;#34;args&amp;#34;:&amp;#34;https://www.kerryplus.com/ulink/testpage&amp;#34;,&amp;#34;来源&amp;#34;:&amp;#34;uniLink&amp;#34;}
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">// android:
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">// eslint-disable-next-line no-console
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c1abea">console&lt;/span>.&lt;span style="color:#c1abea">log&lt;/span>(&lt;span style="color:#98c379">&amp;#39;===&amp;#39;&lt;/span>, &lt;span style="color:#c1abea">JSON&lt;/span>.&lt;span style="color:#c1abea">stringify&lt;/span>(&lt;span style="color:#c1abea">obj&lt;/span>));
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">setTimeout&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">uni&lt;/span>.&lt;span style="color:#c1abea">showToast&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">title&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">JSON&lt;/span>.&lt;span style="color:#c1abea">stringify&lt;/span>(&lt;span style="color:#c1abea">obj&lt;/span>),
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">icon&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#98c379">&amp;#39;none&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">duration&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#d19a66">1000&lt;/span> &lt;span style="color:#c7bf54">*&lt;/span> &lt;span style="color:#d19a66">6&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, &lt;span style="color:#d19a66">500&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#c678dd">catch&lt;/span> { }
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="links">links&lt;/h2>
&lt;h3 id="必读">必读&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://lvan-zhang.blog.csdn.net/article/details/121210350">【精选】可能是最全的h5唤起App方案_h5唤醒app-CSDN博客&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/suanmei/callapp-lib?tab=readme-ov-file">suanmei/callapp-lib: 🔥call app from h5（H5唤起客户端 ）&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://suanmei.github.io/2018/08/23/h5_call_app/">H5唤起APP指南 | 拾壹小筑&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="app-links">app links&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://blog.csdn.net/weixin_38754349/article/details/107724355">Android DEPPLINK、APPLink 原理简析-CSDN博客&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/wupinlong/article/details/109953480">uniApp实现h5页面唤醒app_h5 打开uniapp-CSDN博客&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/question/100042">ios配置完universal links，如何通过universal links跳转到APP内指定页面？ - DCloud问答&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/question/95040">【报Bug】IOS下plus.runtime.arguments不能获取到URL Scheme协议参数【已解决】 - DCloud问答&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/article/36721">面试官：同学，说说 Applink 的使用以及原理 - DCloud问答&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.android.com/training/app-links?hl=zh-cn">处理 Android 应用链接  |  Android 开发者  |  Android Developers&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://zarah.dev/2022/02/08/android12-deeplinks.html">Debugging App Links in Android 12 🔗&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developers.google.com/digital-asset-links/tools/generator?hl=zh-cn">语句列表生成器和测试器  |  Google Digital Asset Links  |  Google for Developers&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.android.com/studio/write/app-link-indexing?hl=zh-cn">添加 Android App Links  |  Android Studio  |  Android Developers&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.51cto.com/u_16099183/7065726">android app links android app links 自动验证失效 1024_mob6454cc63f2dd的技术博客_51CTO博客&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://lleohao.github.io/2020/11/12/Web%20%E9%A1%B5%E9%9D%A2%E8%B0%83%E7%94%A8%20APP%20%E6%96%B9%E5%BC%8F%E6%80%BB%E7%BB%93/">Web 页面打开 APP 方式总结 | Lleo&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/fox_wei_hlz/article/details/102471312">Android的Applink原理解析-8.0源码-CSDN博客&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://open.oppomobile.com/bbs/forum.php?mod=viewthread&amp;amp;tid=5205&amp;amp;extra=page%3D1&amp;amp;aid=46131">Oppo手机无法支持deeplink ，applink唤起应用的问题 - 适配支持 - 开发者社区&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://zhuanlan.zhihu.com/p/37303948">一切为了运营！如何从推广短信链接唤起 App？ - 知乎&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.jianshu.com/p/213557eba7a3">Android 通过短信跳转到特定 App &amp;ndash; Android App Links - 简书&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="url-scheme">url scheme&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://uniapp.dcloud.net.cn/tutorial/app-android-schemes.html#">app-android-schemes - uni-app官网&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.google.com/search?q=UrlSchemes+H5+%E5%AE%89%E5%8D%93+%E6%97%A0%E6%B3%95%E6%89%93%E5%BC%80&amp;amp;newwindow=1&amp;amp;sca_esv=556959823&amp;amp;biw=1888&amp;amp;bih=937&amp;amp;ei=L9LaZKrHIafy0PEPuZaHiAE&amp;amp;ved=0ahUKEwjqmriNv92AAxUnOTQIHTnLAREQ4dUDCA8&amp;amp;uact=5&amp;amp;oq=UrlSchemes+H5+%E5%AE%89%E5%8D%93+%E6%97%A0%E6%B3%95%E6%89%93%E5%BC%80&amp;amp;gs_lp=Egxnd3Mtd2l6LXNlcnAiIVVybFNjaGVtZXMgSDUg5a6J5Y2TIOaXoOazleaJk-W8gDIJECEYoAEYChgqMgcQIRigARgKMgcQIRigARgKSMpXUKMGWJJRcAl4AJABAJgBiQSgAY8zqgEJMi05LjguMS4yuAEDyAEA-AEBwgIKEAAYCBgeGA0YCsICCBAAGAgYHhgNwgIIEAAYiQUYogTCAgUQABiiBOIDBBgBIEGIBgE&amp;amp;sclient=gws-wiz-serp">UrlSchemes H5 安卓 无法打开 - Google 搜索&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/question/65867">uni-app的H5如何跳转到App - DCloud问答&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.jianshu.com/p/21380058d609">H5页面唤起指定app或跳转到应用市场 - 简书&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/question/83564">【报Bug】uni-app小米手机无法唤起app - DCloud问答&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/question/175893">android 配置的schemes不起作用唤醒不了 - DCloud问答&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/question/47639">URL schemes 按官方文档设置无效 - DCloud问答&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/question/157732">关于h5的安卓跳转app的UrlSchemes问题 - DCloud问答&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/question/118293">uniapp UrlSchemes配置 完成后使用浏览器无法打开 - DCloud问答&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/hwb04160011/article/details/106443382">Android配置Scheme使用浏览器唤起APP的方式，以及不生效问题解决-CSDN博客&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/xiaohui_brook/article/details/113241717">uni-app项目Android离线打包UrlSchemes设置_uniapp离线打包配置scheme-CSDN博客&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="test">test&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://answers.netlify.com/t/well-known-gets-ignored/44897">.well-known gets ignored - Support - Netlify Support Forums&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://answers.netlify.com/t/how-to-add-a-well-known-folder-to-my-website/28149">How to add a .well-known folder to my website - Support - Netlify Support Forums&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://app-links.dc1979.com/.well-known/assetlinks.json">app-links.dc1979.com/.well-known/assetlinks.json&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://signal.group/.well-known/assetlinks.json">signal.group/.well-known/assetlinks.json&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ws-srv.glitch.me/app-links.html">Android App&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="ios-上短信链接拉起微信小程序">iOS 上短信链接拉起微信小程序&lt;/h2>
&lt;p>测试短信：【嘉里建设】首页 &lt;a href="https://wxaurl.cn/NAuYl9Mi2wo">https://wxaurl.cn/NAuYl9Mi2wo&lt;/a>&lt;/p>
&lt;p>文档：https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/sms.html&lt;/p>
&lt;p>看起来混合利用了 Universal Links 和 Url Scheme。&lt;/p>
- https://joelz.github.io/tech-blog/posts/20230815-android_app_links/ - Copy, right? 🤔</description></item><item><title>支付宝小程序导航栏自定义方案</title><link>https://joelz.github.io/tech-blog/posts/20230720-mp_alipay_navigation-bar/</link><pubDate>Thu, 20 Jul 2023 12:01:58 +0800</pubDate><guid>https://joelz.github.io/tech-blog/posts/20230720-mp_alipay_navigation-bar/</guid><description>Notes by Joel https://joelz.github.io/tech-blog/posts/20230720-mp_alipay_navigation-bar/ -&lt;h2 id="先看支付宝小程序文档怎么说">先看支付宝小程序文档怎么说&lt;/h2>
&lt;h3 id="导航栏背景色">导航栏背景色&lt;/h3>
&lt;pre tabindex="0">&lt;code>// 若在 app.json 中的 window 中配置，则对全局页面生效
&amp;#34;window&amp;#34;: {
&amp;#34;titleBarColor&amp;#34;: &amp;#34;#FFFFFF&amp;#34;
},
// 若在 page.json 中配置，则对当前页面生效
{
&amp;#34;titleBarColor&amp;#34;: &amp;#34;#FFFFFF&amp;#34;
}
// 也可以使用 my.setNavigationBar() 设置当前页面的导航栏的背景色
my.setNavigationBar({
backgroundColor: &amp;#34;#FFFFFF&amp;#34;
})
&lt;/code>&lt;/pre>&lt;h3 id="导航栏前景色状态栏文字按钮以及标题的颜色">导航栏前景色（状态栏文字、按钮、以及标题的颜色）&lt;/h3>
&lt;pre tabindex="0">&lt;code>// frontColor必须和backgroundColor一起设置才能生效；
// 导航栏背景色会影响导航栏前景色。 若只设置导航栏背景色，则当背景色为 #ffffff时，前景色为黑色，否则前景色为白色。
my.setNavigationBar({
frontColor: &amp;#39;#ffffff&amp;#39;,
backgroundColor: &amp;#39;#000000&amp;#39;
})
&lt;/code>&lt;/pre>&lt;p>&lt;a href="https://opendocs.alipay.com/mini/007l6m?pathHash=3b919f4b">https://opendocs.alipay.com/mini/007l6m?pathHash=3b919f4b&lt;/a>:&lt;/p>
&lt;blockquote>
&lt;p>字体颜色、返回按钮颜色属于导航栏前景色。前景色仅支持 #ffffff 和 #000000。
可以通过 my.setNavigationBar 入参 frontColor 直接修改导航栏前景色（基础库 2.7.24 开始支持）
也可通过 &lt;code>my.setNavigationBar&lt;/code> 入参 &lt;code>backgroundColor&lt;/code> 间接影响导航栏前景色。即当 &lt;code>backgroundColor&lt;/code> 为白色时，前景色为黑色；当 &lt;code>backgroundColor&lt;/code> 为其他颜色时，前景色为白色。&lt;/p>
&lt;/blockquote>
&lt;h2 id="两种方案">两种方案&lt;/h2>
&lt;h3 id="方案1-title-用支付宝原生的">方案1: title 用支付宝原生的&lt;/h3>
&lt;h4 id="背景色不透明">背景色不透明&lt;/h4>
&lt;p>默认就好。&lt;/p>
&lt;h4 id="背景色透明">背景色透明&lt;/h4>
&lt;p>uniapp 的 pages.json 中设置：&lt;/p>
&lt;pre tabindex="0">&lt;code>{
&amp;#34;path&amp;#34;: &amp;#34;color&amp;#34;,
&amp;#34;style&amp;#34;: {
&amp;#34;navigationBarTitleText&amp;#34;: &amp;#34;色彩&amp;#34;,
&amp;#34;enablePullDownRefresh&amp;#34;: false,
&amp;#34;navigationStyle&amp;#34;: &amp;#34;custom&amp;#34;,
&amp;#34;navigationBarBackgroundColor&amp;#34;: &amp;#34;#ffffff&amp;#34;,
&amp;#34;mp-alipay&amp;#34;: {
&amp;#34;transparentTitle&amp;#34;: &amp;#34;auto&amp;#34;,
&amp;#34;titlePenetrate&amp;#34;: &amp;#34;YES&amp;#34;,
&amp;#34;defaultTitle&amp;#34;: &amp;#34;色彩2&amp;#34;
}
}
},
&lt;/code>&lt;/pre>&lt;p>注意&lt;/p>
&lt;ol>
&lt;li>设置了 &lt;code>&amp;quot;transparentTitle&amp;quot;: &amp;quot;always&amp;quot;,&lt;/code> 或者&lt;code> &amp;quot;transparentTitle&amp;quot;: &amp;quot;auto&amp;quot;,&lt;/code> ，要自己处理页面的 padding：
&lt;img src="https://joelz.github.io/tech-blog/tech-blog/images/20230720-mp_alipay_navigation-bar.assets/image-20230720114248859.png" alt="image-20230720114248859">&lt;/li>
&lt;li>前景色受背景色影响，非&lt;code>#ffffff&lt;/code>背景色前景色会变成白色，所以如果背景色设置为类似白色的颜色，title 就不可辨认了。&lt;/li>
&lt;/ol>
&lt;h3 id="方案2-title-设置为空页面自己渲染-title">方案2: title 设置为空，页面自己渲染 title&lt;/h3>
&lt;p>uniapp 的 pages.json 中设置&lt;code>defaultTitle&lt;/code>为空：&lt;/p>
&lt;pre tabindex="0">&lt;code>{
&amp;#34;path&amp;#34;: &amp;#34;color&amp;#34;,
&amp;#34;style&amp;#34;: {
&amp;#34;navigationBarTitleText&amp;#34;: &amp;#34;色彩&amp;#34;,
&amp;#34;enablePullDownRefresh&amp;#34;: false,
&amp;#34;navigationStyle&amp;#34;: &amp;#34;custom&amp;#34;,
&amp;#34;navigationBarBackgroundColor&amp;#34;: &amp;#34;#ffffff&amp;#34;,
&amp;#34;mp-alipay&amp;#34;: {
&amp;#34;transparentTitle&amp;#34;: &amp;#34;always&amp;#34;,
&amp;#34;titlePenetrate&amp;#34;: &amp;#34;YES&amp;#34;,
&amp;#34;defaultTitle&amp;#34;: &amp;#34;&amp;#34;
}
}
},
&lt;/code>&lt;/pre>&lt;p>然后自己写代码渲染 title。&lt;/p>
&lt;h2 id="官方文档">官方文档&lt;/h2>
&lt;ol>
&lt;li>&lt;a href="https://opendocs.alipay.com/mini/07535r?pathHash=a54e002c">导航栏使用须知 - 支付宝文档中心&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://opendocs.alipay.com/mini/077mhs?pathHash=82b5f57f">导航栏行为升级开发者适配指南 - 支付宝文档中心&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://opendocs.alipay.com/mini/007l6m?pathHash=3b919f4b">导航栏 FAQ - 支付宝文档中心&lt;/a>&lt;/li>
&lt;/ol>
- https://joelz.github.io/tech-blog/posts/20230720-mp_alipay_navigation-bar/ - Copy, right? 🤔</description></item><item><title>Iconfont使用笔记</title><link>https://joelz.github.io/tech-blog/posts/20220429-iconfont/</link><pubDate>Fri, 29 Apr 2022 12:01:58 +0800</pubDate><guid>https://joelz.github.io/tech-blog/posts/20220429-iconfont/</guid><description>Notes by Joel https://joelz.github.io/tech-blog/posts/20220429-iconfont/ -&lt;h2 id="iconfont-原理">iconfont 原理&lt;/h2>
&lt;p>&lt;a href="https://www.iconfont.cn/help/article_detail?spm=a313x.7781069.1998910419.d6f75c492&amp;amp;article_id=1">iconfont 字体生成原理及使用技巧 - iconfont.cn&lt;/a>&lt;/p>
&lt;h2 id="创建字体文件">创建字体文件&lt;/h2>
&lt;h3 id="方式1-使用-iconfontcn">方式1: 使用 iconfont.cn&lt;/h3>
&lt;p>iconfont.cn 是阿里出品的 iconfont 管理平台。在 iconfont.cn 新建一个项目，上传 svg，可以生成字体文件和相应的 css。生成的字体文件和 css 可以下载，也可直接引用 iconfont.cn 提供的 alicdn 地址。&lt;/p>
&lt;h3 id="方式2-使用--font-carrierhttpsgithubcompurplebamboofont-carrier">方式2: 使用 &lt;a href="https://github.com/purplebamboo/font-carrier">font-carrier&lt;/a>&lt;/h3>
&lt;blockquote>
&lt;p>&lt;a href="https://github.com/purplebamboo/font-carrier">font-carrier&lt;/a> 是一个功能强大的字体操作库，使用它你可以随心所欲地操作字体。&lt;/p>
&lt;/blockquote>
&lt;p>font-carrier 封装了简单的 API，可以将 SVG 设置成对应的字形，支持导出5种浏览器主流字体（ttf，eot，woff，woff2，svg）&lt;/p>
&lt;h2 id="使用-iconfont">使用 iconfont&lt;/h2>
&lt;h3 id="方式1-unicode-模式">方式1: unicode 模式&lt;/h3>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-css" data-lang="css">&lt;span style="display:flex;">&lt;span>@&lt;span style="color:#c678dd">font-face&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">font-family&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#98c379">&amp;#39;iconfontKIP&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">;&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">/* 自定义字体族名，可以是任意名， */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">src&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#e06c75">url&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;//at.alicdn.com/t/font_1357308_kygursq6jw.eot&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">);&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">/* 字体描述文件链接 */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">src&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#e06c75">url&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;//at.alicdn.com/t/font_1357308_kygursq6jw.eot?#iefix&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">)&lt;/span> &lt;span style="color:#e06c75">format&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;embedded-opentype&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">),&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">/* 兼容 IE9 */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">url&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;//at.alicdn.com/t/font_1357308_kygursq6jw.woff2&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">)&lt;/span> &lt;span style="color:#e06c75">format&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;woff2&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">),&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">/* 兼容 IE6-IE8 */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">url&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;//at.alicdn.com/t/font_1357308_kygursq6jw.woff&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">)&lt;/span> &lt;span style="color:#e06c75">format&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;woff&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">),&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">/* 兼容 chrome, firefox, opera, Safari, Android, iOS 4.2+ */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">url&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;//at.alicdn.com/t/font_1357308_kygursq6jw.ttf&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">)&lt;/span> &lt;span style="color:#e06c75">format&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;truetype&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">),&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">/* 兼容 chrome, firefox, opera, Safari, Android, iOS 4.2+ */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">url&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;//at.alicdn.com/t/font_1357308_kygursq6jw.svg#iconfont&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">)&lt;/span> &lt;span style="color:#e06c75">format&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;svg&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">);&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">/* 兼容 iOS 4.1及以上 */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>.&lt;span style="color:#76a9f9">kip-icon&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">font-size&lt;/span>: &lt;span style="color:#d19a66">24&lt;/span>&lt;span style="color:#ef8383">px&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">font-family&lt;/span>: &lt;span style="color:#98c379">&amp;#39;iconfontKIP&amp;#39;&lt;/span>&lt;span style="color:#8a93a5;font-style:italic">!important&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-css" data-lang="css">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c7bf54">&amp;lt;&lt;/span>&lt;span style="color:#e06c75">span&lt;/span> &lt;span style="color:#e06c75">class&lt;/span>&lt;span style="color:#c7bf54">=&lt;/span>&lt;span style="color:#63c381">&amp;#34;kip-icon&amp;#34;&lt;/span>&lt;span style="color:#c7bf54">&amp;gt;&amp;amp;&lt;/span>#&lt;span style="color:#76a9f9">xe601&lt;/span>&lt;span style="color:#c7bf54">;&amp;lt;/&lt;/span>&lt;span style="color:#e06c75">span&lt;/span>&lt;span style="color:#c7bf54">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="方式2--font-class">方式2: font class&lt;/h3>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">17
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">18
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">19
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">20
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-css" data-lang="css">&lt;span style="display:flex;">&lt;span>@&lt;span style="color:#c678dd">font-face&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">font-family&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#98c379">&amp;#39;iconfontKIP&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">;&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">/* 自定义字体族名，可以是任意名， */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">src&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#e06c75">url&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;//at.alicdn.com/t/font_1357308_kygursq6jw.eot&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">);&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">/* 字体描述文件链接 */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">src&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#e06c75">url&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;//at.alicdn.com/t/font_1357308_kygursq6jw.eot?#iefix&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">)&lt;/span> &lt;span style="color:#e06c75">format&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;embedded-opentype&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">),&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">/* 兼容 IE9 */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">url&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;//at.alicdn.com/t/font_1357308_kygursq6jw.woff2&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">)&lt;/span> &lt;span style="color:#e06c75">format&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;woff2&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">),&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">/* 兼容 IE6-IE8 */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">url&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;//at.alicdn.com/t/font_1357308_kygursq6jw.woff&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">)&lt;/span> &lt;span style="color:#e06c75">format&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;woff&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">),&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">/* 兼容 chrome, firefox, opera, Safari, Android, iOS 4.2+ */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">url&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;//at.alicdn.com/t/font_1357308_kygursq6jw.ttf&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">)&lt;/span> &lt;span style="color:#e06c75">format&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;truetype&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">),&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">/* 兼容 chrome, firefox, opera, Safari, Android, iOS 4.2+ */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e06c75">url&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;//at.alicdn.com/t/font_1357308_kygursq6jw.svg#iconfont&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">)&lt;/span> &lt;span style="color:#e06c75">format&lt;/span>&lt;span style="color:#c7bf54">(&lt;/span>&lt;span style="color:#98c379">&amp;#39;svg&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">);&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">/* 兼容 iOS 4.1及以上 */&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>.&lt;span style="color:#76a9f9">kip-icon&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">font-size&lt;/span>: &lt;span style="color:#d19a66">24&lt;/span>&lt;span style="color:#ef8383">px&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">font-family&lt;/span>: &lt;span style="color:#98c379">&amp;#39;iconfontKIP&amp;#39;&lt;/span>&lt;span style="color:#8a93a5;font-style:italic">!important&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>.&lt;span style="color:#76a9f9">kip-icon-add-plus&lt;/span>:&lt;span style="color:#e5c07b">before&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">content&lt;/span>: &lt;span style="color:#63c381">&amp;#34;\e601&amp;#34;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">/* 其他 icon 的 font class*/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-html" data-lang="html">&lt;span style="display:flex;">&lt;span>&amp;lt;&lt;span style="color:#e06c75">span&lt;/span> &lt;span style="color:#b3d23c">class&lt;/span>&lt;span style="color:#c7bf54">=&lt;/span>&lt;span style="color:#98c379">&amp;#34;kip-icon kip-icon-add-plus&amp;#34;&lt;/span>&amp;gt;&amp;lt;/&lt;span style="color:#e06c75">span&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="方式3-svg-symbol">方式3: SVG Symbol&lt;/h3>
&lt;p>该方式和上述二者有本质区别，Symbol 模式是通过 svg 技术来描绘图标，没有运用到 unicode 编码。由于使用的是 svg 技术，属于图形，而不仅仅是字符。所以该模式支持彩色图标。
首先需要引入 symbol 代码（可以用 iconfont.cn 生成的 js 代码，类似这样的地址：&lt;code>https://at.alicdn.com/t/font_3365994_hcu3r6wt1qj.js&lt;/code>）&lt;/p>
&lt;p>然后写 css 和 svg ：&lt;/p>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">7
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-css" data-lang="css">&lt;span style="display:flex;">&lt;span>.&lt;span style="color:#76a9f9">kip-icon&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">width&lt;/span>: &lt;span style="color:#d19a66">1&lt;/span>&lt;span style="color:#ef8383">em&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">height&lt;/span>: &lt;span style="color:#d19a66">1&lt;/span>&lt;span style="color:#ef8383">em&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">vertical-align&lt;/span>: &lt;span style="color:#d19a66">-0.15&lt;/span>&lt;span style="color:#ef8383">em&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">fill&lt;/span>: &lt;span style="color:#b756ff;font-weight:bold">currentColor&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">overflow&lt;/span>: &lt;span style="color:#b756ff;font-weight:bold">hidden&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-html" data-lang="html">&lt;span style="display:flex;">&lt;span>&amp;lt;&lt;span style="color:#e06c75">svg&lt;/span> &lt;span style="color:#b3d23c">class&lt;/span>&lt;span style="color:#c7bf54">=&lt;/span>&lt;span style="color:#98c379">&amp;#34;kip-icon&amp;#34;&lt;/span> &lt;span style="color:#b3d23c">aria-hidden&lt;/span>&lt;span style="color:#c7bf54">=&lt;/span>&lt;span style="color:#98c379">&amp;#34;true&amp;#34;&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#e06c75">use&lt;/span> &lt;span style="color:#b3d23c">xlink:href&lt;/span>&lt;span style="color:#c7bf54">=&lt;/span>&lt;span style="color:#98c379">&amp;#34;#kip-icon-add-plus&amp;#34;&lt;/span>&amp;gt;&amp;lt;/&lt;span style="color:#e06c75">use&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/&lt;span style="color:#e06c75">svg&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h2 id="如何在线预览字体">如何在线预览字体&lt;/h2>
&lt;p>&lt;a href="https://segmentfault.com/a/1190000020121850">iconfont 在线预览工具及其解析&lt;/a> 中提供了一个工具：&lt;a href="http://blog.luckly-mjw.cn/tool-show/iconfont-preview/index.html">Iconfont Preview&lt;/a>&lt;/p>
&lt;p>备份地址：&lt;a href="https://share.dc1979.com/iconfont/">Iconfont Preview&lt;/a>&lt;/p>
&lt;h2 id="注意事项">注意事项&lt;/h2>
&lt;ol>
&lt;li>在 Android app 和 iOS app 中引入字体文件时，url 中必须带上 https ，写成类似 &lt;code>url('//at.alicdn.com/t/font_1357308_kygursq6jw.woff2') &lt;/code> 不行，字体加载不出来。&lt;/li>
&lt;/ol>
&lt;h2 id="彩色字体">彩色字体&lt;/h2>
&lt;p>因为 iconfont 本质上是字体，所以不支持多色，生成字体过程中彩色的 svg 会被去色（当然后续在 css 中可以再设置其为任意颜色）。&lt;/p>
&lt;p>iconfont.cn 支持彩色字体，用它的彩色字体功能可以把彩色 svg 原样生成字体文件。因为自身已经是多色，所以彩色字体在使用时无法在 css 中改变其颜色。&lt;/p>
&lt;h2 id="links">links&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://www.iconfont.cn/help/article_detail?spm=a313x.7781069.1998910419.d6f75c492&amp;amp;article_id=1">iconfont 字体生成原理及使用技巧 - iconfont&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/purplebamboo/font-carrier">purplebamboo/font-carrier: font-carrier&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.iconfont.cn/help/article_detail?spm=a313x.7781069.1998910419.daea9c966&amp;amp;article_id=7">iconfont.cn 支持全新的彩色字体图标&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/question/57433">uni-app如何引入iconfont图标 - DCloud问答&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://segmentfault.com/a/1190000020121850">iconfont 在线预览工具及其解析 - SegmentFault 思否&lt;/a>&lt;/li>
&lt;/ul>
- https://joelz.github.io/tech-blog/posts/20220429-iconfont/ - Copy, right? 🤔</description></item><item><title>小程序及App内嵌H5</title><link>https://joelz.github.io/tech-blog/posts/20220418-weixin_mp_webview/</link><pubDate>Mon, 18 Apr 2022 12:01:58 +0800</pubDate><guid>https://joelz.github.io/tech-blog/posts/20220418-weixin_mp_webview/</guid><description>Notes by Joel https://joelz.github.io/tech-blog/posts/20220418-weixin_mp_webview/ -&lt;h2 id="微信小程序内嵌-h5">微信小程序内嵌 H5&lt;/h2>
&lt;h3 id="通信机制">通信机制&lt;/h3>
&lt;h4 id="微信小程序向-h5-发送消息">微信小程序向 H5 发送消息&lt;/h4>
&lt;ol>
&lt;li>URL search 传参：在 H5 初始加载时，通常会带上用户的登录态作为参数，使 H5 可以继续与后台交互。类似 &lt;code>https://example.com/h5.html?token=SGVsbG9Xb3JkIQ==&lt;/code>&lt;/li>
&lt;li>URL hash 传参：在 H5 浏览期间，可以 利用网页 URL 中的 hash 部分改变不会导致网页重新加载的特点，实现小程序向 H5 发送消息。但是：&lt;a href="https://ask.dcloud.net.cn/question/125195">【报Bug】UNIAPP H5修改hash模式的URL参数会导致页面重载，以前旧的hbx2.8.11是不会重载的 - DCloud问答&lt;/a>&lt;/li>
&lt;li>websocket&lt;/li>
&lt;/ol>
&lt;h4 id="h5-向微信小程序发送消息">H5 向微信小程序发送消息&lt;/h4>
&lt;ol>
&lt;li>postMessage：小程序内嵌 H5 可以使用 JSSDK 向小程序发送消息。&lt;strong>网页向小程序 postMessage 时，只会在特定时机（小程序后退、组件销毁、分享）触发并收到消息，不是实时触发。e.detail = { data }，data是多次 postMessage 的参数组成的数组&lt;/strong>&lt;/li>
&lt;li>路由传参：在使用 JSSDK 调起小程序页面时，可以通过在页面路径后携带参数的方式通信。类似 &lt;code>wx.miniProgram.navigateTo({ url: '/path/to/page?foo=bar' }) &lt;/code>&lt;/li>
&lt;li>websocket&lt;/li>
&lt;/ol>
&lt;h3 id="不足">不足&lt;/h3>
&lt;ol>
&lt;li>对于需要用户交互才能使用的小程序能力（比如分享，获取用户手机号，获取用户信息，获取用户头像，订阅消息等），需要跳转页面&lt;/li>
&lt;li>WebView 页面的导航栏只能固定用默认的白底黑字风格&lt;/li>
&lt;/ol>
&lt;h3 id="参考链接">参考链接&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://ymcai.xyz/posts/202107021145.html">微信小程序混合开发笔记&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/choutian5268/article/details/100810817">微信小程序+webview+vue混合开发 传值踩坑_choutian5268的博客-CSDN博客&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/question/125195">【报Bug】UNIAPP H5修改hash模式的URL参数会导致页面重载，以前旧的hbx2.8.11是不会重载的 - DCloud问答&lt;/a>
&lt;a href="https://developers.weixin.qq.com/miniprogram/dev/component/web-view.html">- web-view | 微信开放文档&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="app内嵌-h5">App内嵌 H5&lt;/h2>
&lt;h3 id="通信机制-1">通信机制&lt;/h3>
&lt;h4 id="app向-h5-发送消息">App向 H5 发送消息&lt;/h4>
&lt;ol>
&lt;li>&lt;a href="https://www.html5plus.org/doc/zh_cn/webview.html#plus.webview.WebviewObject.evalJS">evalJS&lt;/a>：&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-typescript" data-lang="typescript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c678dd">const&lt;/span> &lt;span style="color:#c1abea">js&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#98c379">`window.settlePromise(&amp;#39;resolve&amp;#39;,`&lt;/span> &lt;span style="color:#c7bf54">+&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#98c379">`&amp;#39;&lt;/span>&lt;span style="color:#98c379">${&lt;/span>&lt;span style="color:#c1abea">res&lt;/span>.&lt;span style="color:#c1abea">detail&lt;/span>.&lt;span style="color:#c1abea">data&lt;/span>[&lt;span style="color:#d19a66">0&lt;/span>].&lt;span style="color:#c1abea">data&lt;/span>.&lt;span style="color:#c1abea">paymentSessionId&lt;/span>&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379">&amp;#39;,`&lt;/span> &lt;span style="color:#c7bf54">+&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#98c379">`&amp;#39;&lt;/span>&lt;span style="color:#98c379">${&lt;/span>&lt;span style="color:#c1abea">JSON&lt;/span>.&lt;span style="color:#c1abea">stringify&lt;/span>(&lt;span style="color:#c1abea">result&lt;/span>)&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379">&amp;#39;)`&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> (&lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">webview&lt;/span> &lt;span style="color:#c678dd">as&lt;/span> &lt;span style="color:#ef8383">any&lt;/span>).&lt;span style="color:#c1abea">evalJS&lt;/span>(&lt;span style="color:#c1abea">js&lt;/span>);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="h5-向app发送消息">H5 向App发送消息&lt;/h4>
&lt;ol>
&lt;li>uni.webView.postMessage：网页向应用发送消息，在 web-view 的 message 事件回调 event.detail.data 中接收消息。实时触发。&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">9
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-typescript" data-lang="typescript">&lt;span style="display:flex;">&lt;span>(&lt;span style="color:#c1abea">uni&lt;/span> &lt;span style="color:#c678dd">as&lt;/span> &lt;span style="color:#ef8383">any&lt;/span>).&lt;span style="color:#c1abea">webView&lt;/span>.&lt;span style="color:#c1abea">postMessage&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">data&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">action&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#98c379">&amp;#39;PAY&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">data&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">payOption&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#98c379">&amp;#39;WECHATPAY&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">paymentSessionId&lt;/span>: &lt;span style="color:#ef8383">sessionId&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="web-view-加载的-html-中可以调用html--5-的能力">web-view 加载的 HTML 中可以调用html 5+ 的能力&lt;/h4>
&lt;p>比如HTML5+ 中的 &lt;a href="https://www.html5plus.org/doc/zh_cn/barcode.html">扫码&lt;/a>&lt;/p>
&lt;h3 id="不足-1">不足&lt;/h3>
&lt;ol>
&lt;li>iOS App 侧滑会关闭整个webview&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/question/101333">uniapp如何监听或者知道ios左滑返回事件？ - DCloud问答&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/article/35120">uni-app自定义返回逻辑教程 - DCloud问答&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="参考链接-1">参考链接&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://uniapp.dcloud.io/component/web-view.html">web-view | uni-app官网&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.html5plus.org/doc/zh_cn/webview.html#plus.webview.WebviewObject.evalJS">evalJS - HTML5+ API Reference&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="支付宝小程序内嵌-h5">支付宝小程序内嵌 H5&lt;/h2>
&lt;h3 id="通信机制-2">通信机制&lt;/h3>
&lt;p>很方便，支持双向即时通信。&lt;/p>
&lt;h4 id="h5-端代码">H5 端代码&lt;/h4>
&lt;p>首先需要在 &lt;code>index.html&lt;/code> 中引入 js sdk：&lt;/p>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-html" data-lang="html">&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#e06c75">script&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">if&lt;/span> (&lt;span style="color:#c1abea">navigator&lt;/span>.&lt;span style="color:#c1abea">userAgent&lt;/span>.&lt;span style="color:#c1abea">indexOf&lt;/span>(&lt;span style="color:#98c379">&amp;#39;AliApp&amp;#39;&lt;/span>) &lt;span style="color:#c7bf54">&amp;gt;&lt;/span> &lt;span style="color:#c7bf54">-&lt;/span>&lt;span style="color:#d19a66">1&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ef8383">document&lt;/span>.&lt;span style="color:#c1abea">writeln&lt;/span>(&lt;span style="color:#98c379">&amp;#39;&amp;lt;script src=&amp;#34;https://appx/web-view.min.js&amp;#34;&amp;#39;&lt;/span> &lt;span style="color:#c7bf54">+&lt;/span> &lt;span style="color:#98c379">&amp;#39;&amp;gt;&amp;#39;&lt;/span> &lt;span style="color:#c7bf54">+&lt;/span> &lt;span style="color:#98c379">&amp;#39;&amp;lt;&amp;#39;&lt;/span> &lt;span style="color:#c7bf54">+&lt;/span> &lt;span style="color:#98c379">&amp;#39;/&amp;#39;&lt;/span> &lt;span style="color:#c7bf54">+&lt;/span> &lt;span style="color:#98c379">&amp;#39;script&amp;gt;&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/&lt;span style="color:#e06c75">script&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#e06c75">script&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">// 网页向小程序 postMessage 消息
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">// my.postMessage({ name: &amp;#34;测试web-view&amp;#34; });
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">// 接收来自小程序的消息。
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c1abea">my&lt;/span>.&lt;span style="color:#c1abea">onMessage&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c678dd">function&lt;/span> (&lt;span style="color:#c1abea">e&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">console&lt;/span>.&lt;span style="color:#c1abea">log&lt;/span>(&lt;span style="color:#98c379">&amp;#39;message from webview: &amp;#39;&lt;/span>,&lt;span style="color:#c1abea">e&lt;/span>); &lt;span style="color:#8a93a5;font-style:italic">// {&amp;#39;sendToWebView&amp;#39;: &amp;#39;1&amp;#39;}
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/&lt;span style="color:#e06c75">script&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>在 vue 页面中发送消息：&lt;/p>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">15
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-vue" data-lang="vue">&lt;span style="display:flex;">&lt;span>&amp;lt;&lt;span style="color:#e06c75">template&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#e06c75">view&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#e06c75">button&lt;/span> &lt;span style="color:#e06c75">@click&lt;/span>&lt;span style="color:#98c379">=&amp;#34;send&amp;#34;&lt;/span>&amp;gt;&lt;span style="color:#b3d23c">Send&lt;/span>&amp;lt;/&lt;span style="color:#e06c75">button&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/&lt;span style="color:#e06c75">view&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/&lt;span style="color:#e06c75">template&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;&lt;span style="color:#e06c75">script&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">export&lt;/span> &lt;span style="color:#c678dd">default&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">methods&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">send&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c678dd">function&lt;/span> () {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">my&lt;/span>.&lt;span style="color:#c1abea">postMessage&lt;/span>({&lt;span style="color:#c1abea">name&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span>&lt;span style="color:#63c381">&amp;#34;测试web-view&amp;#34;&lt;/span>, &lt;span style="color:#c1abea">time&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> (&lt;span style="color:#c678dd">new&lt;/span> &lt;span style="color:#ef8383">Date&lt;/span>()).&lt;span style="color:#c1abea">toString&lt;/span>()});
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/&lt;span style="color:#e06c75">script&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h4 id="支付宝小程序代码uniapp">支付宝小程序代码（uniapp）&lt;/h4>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">17
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">18
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">19
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">20
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">21
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">22
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">23
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">24
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">25
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">26
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">27
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">28
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">29
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">30
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">31
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">32
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">33
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">34
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">35
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">36
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">37
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">38
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">39
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">40
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">41
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">42
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">43
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">44
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">45
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">46
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">47
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">48
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">49
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">50
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-vue" data-lang="vue">&lt;span style="display:flex;">&lt;span>&amp;lt;&lt;span style="color:#e06c75">template&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#e06c75">view&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;&lt;span style="color:#e06c75">web-view&lt;/span> &lt;span style="color:#b3d23c">id&lt;/span>&lt;span style="color:#c7bf54">=&lt;/span>&lt;span style="color:#98c379">&amp;#34;web-view-1&amp;#34;&lt;/span> &lt;span style="color:#e06c75">:src&lt;/span>&lt;span style="color:#c7bf54">=&lt;/span>&lt;span style="color:#98c379">&amp;#34;url&amp;#34;&lt;/span> &lt;span style="color:#e06c75">@message&lt;/span>&lt;span style="color:#98c379">=&amp;#34;onmessage&amp;#34;&lt;/span>&amp;gt;&amp;lt;/&lt;span style="color:#b3d23c">web&lt;/span>&lt;span style="color:#e06c75">-view&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &amp;lt;/&lt;span style="color:#e06c75">view&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/&lt;span style="color:#e06c75">template&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;&lt;span style="color:#e06c75">script&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">var&lt;/span> &lt;span style="color:#c1abea">app&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c1abea">getApp&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">export&lt;/span> &lt;span style="color:#c678dd">default&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">data&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">return&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">url&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span>&lt;span style="color:#98c379">&amp;#39;&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">onLoad&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c678dd">function&lt;/span>(&lt;span style="color:#c1abea">options&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">url&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#ef8383">decodeURIComponent&lt;/span>(&lt;span style="color:#c1abea">options&lt;/span>.&lt;span style="color:#c1abea">url&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">setTimeout&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">// 往 webview h5 发送一条消息
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c678dd">const&lt;/span> &lt;span style="color:#c1abea">webViewContext&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c1abea">my&lt;/span>.&lt;span style="color:#c1abea">createWebViewContext&lt;/span>(&lt;span style="color:#98c379">&amp;#39;web-view-1&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">webViewContext&lt;/span>.&lt;span style="color:#c1abea">postMessage&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#98c379">&amp;#39;event&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#98c379">&amp;#39;onLoad&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#98c379">&amp;#39;time&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> (&lt;span style="color:#c678dd">new&lt;/span> &lt;span style="color:#ef8383">Date&lt;/span>()).&lt;span style="color:#c1abea">toString&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }, &lt;span style="color:#d19a66">1000&lt;/span>&lt;span style="color:#c7bf54">*&lt;/span>&lt;span style="color:#d19a66">10&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">onShareAppMessage&lt;/span>(&lt;span style="color:#c1abea">options&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">my&lt;/span>.&lt;span style="color:#c1abea">alert&lt;/span>({ &lt;span style="color:#c1abea">content&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">JSON&lt;/span>.&lt;span style="color:#c1abea">stringify&lt;/span>(&lt;span style="color:#c1abea">options&lt;/span>.&lt;span style="color:#c1abea">webViewUrl&lt;/span>) });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">return&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">title&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#98c379">&amp;#39;分享 web-View 组件&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">desc&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#98c379">&amp;#39;View 组件很通用&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">path&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#98c379">&amp;#39;page/component/component-pages/webview/baidu&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#98c379">&amp;#39;web-view&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">options&lt;/span>.&lt;span style="color:#c1abea">webViewUrl&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">methods&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">// 接收从 webview h5 发来的消息
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c1abea">onmessage&lt;/span>(&lt;span style="color:#c1abea">e&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">console&lt;/span>.&lt;span style="color:#c1abea">log&lt;/span>(&lt;span style="color:#98c379">&amp;#39;===&amp;gt; message from webview h5:&amp;#39;&lt;/span>,&lt;span style="color:#c1abea">e&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">setTimeout&lt;/span>(()=&amp;gt;{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">// 5 秒后再往 webview h5 发送一条消息
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c678dd">const&lt;/span> &lt;span style="color:#c1abea">webViewContext&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c1abea">my&lt;/span>.&lt;span style="color:#c1abea">createWebViewContext&lt;/span>(&lt;span style="color:#98c379">&amp;#39;web-view-1&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">webViewContext&lt;/span>.&lt;span style="color:#c1abea">postMessage&lt;/span>({
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#98c379">&amp;#39;sendToWebView&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#98c379">&amp;#39;1&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#98c379">&amp;#39;time&amp;#39;&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> (&lt;span style="color:#c678dd">new&lt;/span> &lt;span style="color:#ef8383">Date&lt;/span>()).&lt;span style="color:#c1abea">toString&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },&lt;span style="color:#d19a66">1000&lt;/span>&lt;span style="color:#c7bf54">*&lt;/span>&lt;span style="color:#d19a66">5&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&amp;lt;/&lt;span style="color:#e06c75">script&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="参考链接-2">参考链接&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://opendocs.alipay.com/mini/component/web-view">web-view H5 页面承载 - 支付宝文档中心&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://opendocs.alipay.com/mini/component/mg7rvg">web-view 常见问题 - 支付宝文档中心&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://uniapp.dcloud.net.cn/component/web-view.html#">web-view | uni-app官网&lt;/a>&lt;/li>
&lt;/ul>
- https://joelz.github.io/tech-blog/posts/20220418-weixin_mp_webview/ - Copy, right? 🤔</description></item><item><title>vue web app 接入 Azure AD SSO</title><link>https://joelz.github.io/tech-blog/posts/20211208-vue_azure_ad_sso/</link><pubDate>Wed, 08 Dec 2021 12:01:58 +0800</pubDate><guid>https://joelz.github.io/tech-blog/posts/20211208-vue_azure_ad_sso/</guid><description>Notes by Joel https://joelz.github.io/tech-blog/posts/20211208-vue_azure_ad_sso/ -&lt;h2 id="第三方应用接入azure-ad-sso流程">第三方应用接入Azure AD SSO流程&lt;/h2>
&lt;ol>
&lt;li>确定账号体系的对应关系（SP 中的账号和 AAD 中的哪个字段对应）&lt;/li>
&lt;li>确定接入协议（SAML 还是 OAuth）&lt;/li>
&lt;li>确定 SP 中有哪些类型的应用要集成（SAP，Web App，Web API，Desktop，Mobile）&lt;/li>
&lt;li>确定接入方案&lt;/li>
&lt;li>新建 dev AAD 的application，创建配置&lt;/li>
&lt;li>SP 方开发和测试&lt;/li>
&lt;li>（可选）有些事项需要找香港同事确认&lt;/li>
&lt;li>PROD AAD 配置&lt;/li>
&lt;li>SP 方测试 PROD AAD 配置无误&lt;/li>
&lt;li>上线&lt;/li>
&lt;/ol>
&lt;h2 id="oauth-in-azure-ad">OAuth in Azure AD&lt;/h2>
&lt;p>SSO_in_Azure_AD_using_OAuth_OIDC_20220520.pptx&lt;/p>
&lt;h3 id="default-access-token-是-jwt但是无法验证签名--invalid-signature">default access token 是 jwt，但是无法验证签名 Invalid signature&lt;/h3>
&lt;p>&lt;a href="https://stackoverflow.com/questions/45317152/invalid-signature-while-validating-azure-ad-access-token-but-id-token-works">validation - Invalid signature while validating Azure ad access token, but id token works - Stack Overflow&lt;/a>&lt;/p>
&lt;h3 id="oidc-in-oauth">OIDC in OAuth&lt;/h3>
&lt;p>&lt;a href="https://darutk.medium.com/diagrams-of-all-the-openid-connect-flows-6968e3990660">Diagrams of All The OpenID Connect Flows | by Takahiko Kawasaki | Medium&lt;/a>&lt;/p>
&lt;h2 id="saml-in-azure-ad">SAML in Azure AD&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://auth0.com/blog/how-saml-authentication-works/">What is SAML and how does SAML Authentication Work&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="saml-配置">SAML 配置&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/active-directory-saml-protocol-reference">How the Microsoft identity platform uses the SAML protocol - Microsoft identity platform | Microsoft Docs&lt;/a>
-&lt;a href="https://docs.microsoft.com/en-us/azure/active-directory/fundamentals/auth-saml">SAML authentication with Azure Active Directory | Microsoft Docs&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://help.aliyun.com/document_detail/312185.html">通过SAML集成Azure AD&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://cloud.tencent.com/document/product/598/35713">访问管理 Azure Active Directory 单点登录腾讯云指南-用户指南-文档中心-腾讯云-腾讯云&lt;/a>&lt;/li>
&lt;/ul>
&lt;h3 id="saml-in-msaljs">SAML in MSAL.js?&lt;/h3>
&lt;ul>
&lt;li>&lt;a href="https://github.com/AzureAD/microsoft-authentication-library-for-java/issues/329">What about supporting SAML 2.0 in this library? · Issue #329 · AzureAD/microsoft-authentication-library-for-java&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://stackoverflow.com/questions/63495395/acquire-a-saml-token-in-msal-js">jwt - Acquire a SAML token in MSAL.js - Stack Overflow&lt;/a>：&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>Also ,&lt;a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/single-sign-on-saml-protocol">Single Sign-On SAML protocol&lt;/a> and &lt;a href="https://docs.microsoft.com/en-us/azure/active-directory/hybrid/how-to-connect-fed-saml-idp">Federated Authentication with a SAML Identity Provider&lt;/a> should be good starting points to implement SAML directly.&lt;/p>
&lt;/blockquote>
&lt;h3 id="例子">例子&lt;/h3>
&lt;p>例子（里面还有用azure saml 的示例，部署在 &lt;a href="https://aad-saml.glitch.me/">https://aad-saml.glitch.me/&lt;/a> ）：https://github.com/joelz/certificates-sample&lt;/p>
&lt;p>asp.net 可以用的库：&lt;a href="https://github.com/jitbit/AspNetSaml?tab=readme-ov-file">jitbit/AspNetSaml: Very simple SAML 2.0 consumer module for ASP.NET/C#&lt;/a>&lt;/p>
&lt;h4 id="saml-101">SAML 101&lt;/h4>
&lt;ul>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/single-sign-on-saml-protocol">Azure Single Sign On SAML Protocol - Microsoft identity platform | Microsoft Docs&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/azure/active-directory/manage-apps/add-application-portal-setup-sso">Quickstart: Set up SAML-based single sign-on (SSO) for an application in your Azure Active Directory (Azure AD) tenant | Microsoft Docs&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://learning.postman.com/docs/administration/sso/saml-in-azure-ad/">Custom SAML in Azure AD | Postman Learning Center&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://matthijs.hoekstraonline.net/2020/04/14/authenticate-an-azure-ad-user-with-saml-for-asp-net-core/">Authenticate an Azure AD user with SAML for ASP.NET Core - Matthijs&amp;rsquo;s Blog&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://cmatskas.com/asp-net-core-saml-authentication-with-azure-ad/">ASP.NET Core SAML Authentication with Azure AD&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://stackoverflow.com/questions/55408087/azure-single-sign-on-using-saml-2-0-protocol-and-asp-net-c-sharp">Azure Single Sign-On using SAML 2.0 Protocol and ASP.NET C# - Stack Overflow&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="保护api">保护API&lt;/h2>
&lt;p>自定义scope，或者自定义 app roles。&lt;/p>
&lt;p>&lt;a href="https://stackoverflow.com/questions/50128504/how-to-control-set-permissions-for-a-single-user-when-using-azure-ad-b2c">oauth 2.0 - How to control/set permissions for a single user when using Azure AD B2C - Stack Overflow&lt;/a>
&lt;a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-add-app-roles-in-azure-ad-apps">Add app roles and get them from a token - Microsoft identity platform | Microsoft Docs&lt;/a>&lt;/p>
&lt;p>👇下面的说法不对。&lt;/p>
&lt;p>=====&lt;/p>
&lt;p>拿到access_token 去访问 resource owner，怎么知道权限呢？scope。
kip 里面拿到acess_token，仍然是去找 microsoft graph 问他是谁，难道 ms graph 是一个 resource owner？对的。所以Azure Portal 中配置 Application 时需要在 API Permissions 中更加上MS Graph 相关的 Permission&lt;/p>
&lt;p>自己的App（即resource owner，简称RO）中要加权限控制，整个配置的流程是这样的：&lt;/p>
&lt;ol>
&lt;li>为client app注册application：&lt;a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-register-app">Quickstart: Register an app in the Microsoft identity platform - Microsoft identity platform | Microsoft Docs&lt;/a>&lt;/li>
&lt;li>为RO配置权限。文档中叫Expose an API，可以理解为RO是一个大的API，不同权限对应不同的scope。添加scope：&lt;a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-configure-app-expose-web-apis">Quickstart: Register and expose a web API - Microsoft identity platform | Microsoft Docs&lt;/a>&lt;/li>
&lt;li>为RO添加的permission，包括了微软提供的一些permission（比如 MS Graph 的permission）和我们自己定义的scope对应的permission：&lt;a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/quickstart-configure-app-access-web-apis">Quickstart: Configure an app to access a web API - Microsoft identity platform | Microsoft Doc&lt;/a>&lt;/li>
&lt;/ol>
&lt;h1 id="s端集成azure-ad-sso">S端集成Azure AD SSO&lt;/h1>
&lt;h2 id="基础概念">基础概念&lt;/h2>
&lt;ol>
&lt;li>Azure AD是微软提供的云服务，它是一个多租户系统。公司是Azure AD的一个租户（或者叫域），对应的租户名称是kerryprops.com。我们开发时会使用一个测试用的租户，租户名称为kpltest.onmicrosoft.com。&lt;/li>
&lt;li>SSO：单点登录。整个单点登录过程中，会涉及到用户、身份提供商（Identity Provider，简称IdP）和服务提供商（Service Provider，简称SP）。在S端用户登录这个场景中，Azure AD 是 IdP，S端是SP同时也是IdP（因为我们有自己的Profile Service）。整个SSO的目的就是用Azure AD的token去换回S端的token（因为调用后端Service API使用的是S端的token，而非Azure AD的token）&lt;/li>
&lt;li>涉及到多个 IdP 的 SSO 有很多方式可以实现，比如 SAML 2.0，WS-Federation，OpenID Connect（OIDC）和 OAuth。S端是一个前后端分离的单页应用（SPA），采用的是&lt;a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/scenario-spa-overview#overview">OAuth 2.0 Authorization code flow (with PKCE)&lt;/a>。页面请求顺序如下图：
&lt;img src="./assets/admin-portal-sso.png" alt="admin-portal-sso.png">&lt;/li>
&lt;li>MSAL库：Microsoft Authentication Library，微软官方出品的类库，可方便地处理使用Azure AD做SSO的各类场景。有各种语言的版本。JavaScript语言的版本叫 &lt;a href="https://github.com/AzureAD/microsoft-authentication-library-for-js">MSAL.js&lt;/a>&lt;/li>
&lt;/ol>
&lt;h2 id="azure-ad上的配置">Azure AD上的配置&lt;/h2>
&lt;p>这部分需要Azure AD的管理员才能配置。管理员登录到Azure AD Portal: &lt;a href="https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade">https://portal.azure.com/#blade/Microsoft_AAD_RegisteredApps/ApplicationsListBlade&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>如果想自己尝试配置和管理一个Azure AD的租户，可以用个人的微软账号（比如live.com/hotmail.com/outlook.com 邮箱账号）去申请&lt;a href="https://developer.microsoft.com/en-us/microsoft-365/dev-program">Microsoft 365 Developer Program&lt;/a>，可以得到一个免费的Azure AD租户。&lt;/p>
&lt;/blockquote>
&lt;h2 id="s端代码说明">S端代码说明&lt;/h2>
&lt;p>使用的npm pacakge：&lt;a href="https://www.npmjs.com/package/@azure/msal-browser">@azure/msal-browser - npm&lt;/a>（就是上文说到的 MSAL.js ）&lt;/p>
&lt;h3 id="配置项">配置项&lt;/h3>
&lt;p>配置项写在 &lt;code>src/store/modules/user.js&lt;/code> 中：&lt;/p>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">msalLoginRequest&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">scopes&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> [&lt;span style="color:#98c379">&amp;#39;openid&amp;#39;&lt;/span>, &lt;span style="color:#98c379">&amp;#39;profile&amp;#39;&lt;/span>, &lt;span style="color:#98c379">&amp;#39;User.Read&amp;#39;&lt;/span>], &lt;span style="color:#8a93a5;font-style:italic">// 对应上文中的 API Permissions
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">msalUseRedirect&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">process&lt;/span>.&lt;span style="color:#c1abea">env&lt;/span>.&lt;span style="color:#c1abea">VUE_APP_AZURE_USE_REDIRECT&lt;/span> &lt;span style="color:#c7bf54">==&lt;/span> &lt;span style="color:#98c379">&amp;#39;true&amp;#39;&lt;/span>, &lt;span style="color:#8a93a5;font-style:italic">// 参见下文说明1
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c1abea">msalConfig&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> { &lt;span style="color:#8a93a5;font-style:italic">// 参见下文说明2
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c1abea">auth&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">clientId&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">getAzureConfig&lt;/span>().&lt;span style="color:#c1abea">clientId&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">authority&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#c1abea">getAzureConfig&lt;/span>().&lt;span style="color:#c1abea">authority&lt;/span>, &lt;span style="color:#8a93a5;font-style:italic">// 里面有tenantId
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c1abea">navigateToLoginRequestUrl&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#b756ff;font-weight:bold">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">cache&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">cacheLocation&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#98c379">&amp;#39;localStorage&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>说明：&lt;/p>
&lt;ol>
&lt;li>这个选项是用来控制浏览器从S端登录页到Azure AD登录页时使用跳转还是弹窗。参考这里：https://docs.microsoft.com/en-us/azure/active-directory/develop/scenario-spa-sign-in?tabs=javascript2#choosing-between-a-pop-up-or-redirect-experience&lt;/li>
&lt;li>Configuration Options完整文档在这里：https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-browser/docs/configuration.md&lt;/li>
&lt;/ol>
&lt;h3 id="初始化-msal-实例">初始化 MSAL 实例&lt;/h3>
&lt;p>在 &lt;code>src/main.js&lt;/code> 中：&lt;/p>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">3
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#c1abea">Vue&lt;/span>.&lt;span style="color:#c1abea">prototype&lt;/span>.&lt;span style="color:#c1abea">$msalInstance&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c678dd">new&lt;/span> &lt;span style="color:#c1abea">PublicClientApplication&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">store&lt;/span>.&lt;span style="color:#c1abea">state&lt;/span>.&lt;span style="color:#c1abea">user&lt;/span>.&lt;span style="color:#c1abea">msalConfig&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>);
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="登录">登录&lt;/h3>
&lt;p>在 &lt;code>src/views/login.vue&lt;/code> 中：&lt;/p>
&lt;div class="highlight">&lt;div style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
&lt;table style="border-spacing:0;padding:0;margin:0;border:0;">&lt;tr>&lt;td style="vertical-align:top;padding:0;margin:0;border:0;">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 1
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 2
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 3
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 4
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 5
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 6
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 7
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 8
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f"> 9
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">10
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">11
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">12
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">13
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">14
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">15
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">16
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">17
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">18
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">19
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">20
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">21
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">22
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">23
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">24
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">25
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">26
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">27
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">28
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">29
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">30
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">31
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">32
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">33
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">34
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">35
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">36
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">37
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">38
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">39
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">40
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">41
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">42
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">43
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">44
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">45
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">46
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">47
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">48
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">49
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">50
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">51
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">52
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">53
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">54
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">55
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">56
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">57
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">58
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">59
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">60
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">61
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">62
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">63
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">64
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">65
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">66
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">67
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">68
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">69
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">70
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">71
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">72
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">73
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">74
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">75
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">76
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">77
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">78
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">79
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">80
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">81
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">82
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">83
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">84
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">85
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">86
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">87
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">88
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">89
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">90
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">91
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">92
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">93
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">94
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">95
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">96
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">97
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">98
&lt;/span>&lt;span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#58626f">99
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
&lt;pre tabindex="0" style="color:#b0c4de;background-color:#282c34;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">mounted&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">// ....
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">// 如果从S端登录页到Azure AD登录页时使用跳转方式，当用户在Azure AD登录成功时
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">// 浏览器会跳转会 /login，同时url中会带上#code=xxxxx，
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">// 从code的值中可用解析出Azure AD的token
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c678dd">if&lt;/span> (&lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">$store&lt;/span>.&lt;span style="color:#c1abea">state&lt;/span>.&lt;span style="color:#c1abea">user&lt;/span>.&lt;span style="color:#c1abea">msalUseRedirect&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">const&lt;/span> &lt;span style="color:#c1abea">code&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#ef8383">document&lt;/span>.&lt;span style="color:#c1abea">location&lt;/span>.&lt;span style="color:#c1abea">href&lt;/span>.&lt;span style="color:#c1abea">split&lt;/span>(&lt;span style="color:#98c379">&amp;#39;#&amp;#39;&lt;/span>).&lt;span style="color:#c1abea">pop&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">if&lt;/span> (&lt;span style="color:#c1abea">code&lt;/span> &lt;span style="color:#c7bf54">&amp;amp;&amp;amp;&lt;/span> &lt;span style="color:#c1abea">code&lt;/span>.&lt;span style="color:#c1abea">indexOf&lt;/span>(&lt;span style="color:#98c379">&amp;#39;code=&amp;#39;&lt;/span>) &lt;span style="color:#c7bf54">===&lt;/span> &lt;span style="color:#d19a66">0&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">console&lt;/span>.&lt;span style="color:#c1abea">log&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#98c379">&amp;#39;AAD_SSO&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#98c379">&amp;#39;Find auth code in path, starting handleRedirectPromise...&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">loading&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#b756ff;font-weight:bold">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">$msalInstance&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .&lt;span style="color:#c1abea">handleRedirectPromise&lt;/span>()
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .&lt;span style="color:#c1abea">then&lt;/span>((&lt;span style="color:#c1abea">resp&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">console&lt;/span>.&lt;span style="color:#c1abea">log&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#98c379">&amp;#39;AAD_SSO&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#98c379">&amp;#39;handleRedirectPromise on mounted done&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">resp&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">let&lt;/span> &lt;span style="color:#c1abea">accessToken&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c1abea">resp&lt;/span>.&lt;span style="color:#c1abea">accessToken&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">msalLogin&lt;/span>(&lt;span style="color:#c1abea">accessToken&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .&lt;span style="color:#c678dd">catch&lt;/span>((&lt;span style="color:#c1abea">err&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">console&lt;/span>.&lt;span style="color:#c1abea">error&lt;/span>(&lt;span style="color:#c1abea">err&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">loading&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#b756ff;font-weight:bold">false&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">methods&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">// acquireTokenSilent，成功则调用下面的msalLogin；
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">// 失败则调用 getMsalAccessTokenViaInteractiveMode
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">// 目前未用到
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c678dd">async&lt;/span> &lt;span style="color:#c1abea">getMsalAccessToken&lt;/span>(&lt;span style="color:#c1abea">account&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">loading&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#b756ff;font-weight:bold">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">const&lt;/span> &lt;span style="color:#c1abea">request&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> { &lt;span style="color:#8a93a5;font-style:italic">// // 参见下文说明1
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c1abea">scopes&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> [&lt;span style="color:#98c379">&amp;#39;User.Read&amp;#39;&lt;/span>],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">prompt&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#98c379">&amp;#39;select_account&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">try&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">let&lt;/span> &lt;span style="color:#c1abea">tokenResponse&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c678dd">await&lt;/span> &lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">$msalInstance&lt;/span>.&lt;span style="color:#c1abea">acquireTokenSilent&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">request&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">console&lt;/span>.&lt;span style="color:#c1abea">log&lt;/span>(&lt;span style="color:#98c379">&amp;#39;setAccessToken&amp;#39;&lt;/span>, &lt;span style="color:#c1abea">tokenResponse&lt;/span>.&lt;span style="color:#c1abea">accessToken&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">msalLogin&lt;/span>(&lt;span style="color:#c1abea">tokenResponse&lt;/span>.&lt;span style="color:#c1abea">accessToken&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#c678dd">catch&lt;/span> (&lt;span style="color:#c1abea">error&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">console&lt;/span>.&lt;span style="color:#c1abea">error&lt;/span>(&lt;span style="color:#c1abea">error&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">console&lt;/span>.&lt;span style="color:#c1abea">error&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#98c379">&amp;#39;Silent token acquisition failed. Using interactive mode&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">getMsalAccessTokenViaInteractiveMode&lt;/span>();
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">// 交互模式登录：弹窗或者跳转到Azure AD登录页面，完成登录，获取到Azure AD的token
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c678dd">async&lt;/span> &lt;span style="color:#c1abea">getMsalAccessTokenViaInteractiveMode&lt;/span>() {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">loading&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#b756ff;font-weight:bold">true&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">// https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-browser/docs/request-response-object.md
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c678dd">const&lt;/span> &lt;span style="color:#c1abea">request&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">scopes&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> [&lt;span style="color:#98c379">&amp;#39;User.Read&amp;#39;&lt;/span>],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">prompt&lt;/span>&lt;span style="color:#c7bf54">:&lt;/span> &lt;span style="color:#98c379">&amp;#39;select_account&amp;#39;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> };
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">console&lt;/span>.&lt;span style="color:#c1abea">info&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#98c379">&amp;#39;Using interactive mode to msal get access token...&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">if&lt;/span> (&lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">$store&lt;/span>.&lt;span style="color:#c1abea">state&lt;/span>.&lt;span style="color:#c1abea">user&lt;/span>.&lt;span style="color:#c1abea">msalUseRedirect&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">$msalInstance&lt;/span>.&lt;span style="color:#c1abea">acquireTokenRedirect&lt;/span>(&lt;span style="color:#c1abea">request&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> } &lt;span style="color:#c678dd">else&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">let&lt;/span> &lt;span style="color:#c1abea">tokenResponse&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#c678dd">await&lt;/span> &lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">$msalInstance&lt;/span>.&lt;span style="color:#c1abea">acquireTokenPopup&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">request&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">console&lt;/span>.&lt;span style="color:#c1abea">log&lt;/span>(
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#98c379">`Access token acquired via interactive auth &lt;/span>&lt;span style="color:#98c379">${&lt;/span>&lt;span style="color:#c1abea">tokenResponse&lt;/span>.&lt;span style="color:#c1abea">accessToken&lt;/span>&lt;span style="color:#98c379">}&lt;/span>&lt;span style="color:#98c379">`&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> );
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">msalLogin&lt;/span>(&lt;span style="color:#c1abea">tokenResponse&lt;/span>.&lt;span style="color:#c1abea">accessToken&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">// 调用profile serivce接口，用Azure AD的token去获取S端可用的token
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">// 完成登录过程
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#8a93a5;font-style:italic">// Azure AD的token可以用微软提供的接口 https://graph.microsoft.com/v1.0/me 来验证
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> &lt;span style="color:#c678dd">async&lt;/span> &lt;span style="color:#c1abea">msalLogin&lt;/span>(&lt;span style="color:#c1abea">msalAccessToken&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">$store&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .&lt;span style="color:#c1abea">dispatch&lt;/span>(&lt;span style="color:#98c379">&amp;#39;MsalLogin&amp;#39;&lt;/span>, &lt;span style="color:#c1abea">msalAccessToken&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .&lt;span style="color:#c1abea">then&lt;/span>(() =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">console&lt;/span>.&lt;span style="color:#c1abea">log&lt;/span>(&lt;span style="color:#98c379">&amp;#39;Msal login finally done!!!&amp;#39;&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">// 。。。。
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> })
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> .&lt;span style="color:#c678dd">catch&lt;/span>((&lt;span style="color:#c1abea">e&lt;/span>) =&amp;gt; {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c1abea">console&lt;/span>.&lt;span style="color:#c1abea">error&lt;/span>(&lt;span style="color:#c1abea">e&lt;/span>);
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#c678dd">this&lt;/span>.&lt;span style="color:#c1abea">loading&lt;/span> &lt;span style="color:#c7bf54">=&lt;/span> &lt;span style="color:#b756ff;font-weight:bold">false&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> });
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> },
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#8a93a5;font-style:italic">// ...
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#8a93a5;font-style:italic">&lt;/span> },
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>说明：&lt;/p>
&lt;ol>
&lt;li>Request 和 Response 对象的完整文档在这里：https://github.com/AzureAD/microsoft-authentication-library-for-js/blob/dev/lib/msal-browser/docs/request-response-object.md&lt;/li>
&lt;/ol>
&lt;h3 id="登出">登出&lt;/h3>
&lt;p>登出时不涉及Azure AD的登出，只是删除S端自己的token即可。&lt;/p>
&lt;h2 id="其他">其他&lt;/h2>
&lt;h3 id="登录报错pkce-not-created">登录报错：pkce not created&lt;/h3>
&lt;p>by yuyang in SKC。错误信息如下：&lt;/p>
&lt;pre tabindex="0">&lt;code>uncaught (in promise) BrowserAuthError:app.24961a1a.j5:141
pkce not created: The PKCE code challenge and verifier could not be generated. Detail TypeError: Cannot read property &amp;#39;digest&amp;#39; of undefined at t les constructor@ (https: //static.kerryprops.com.cn/kip/kip-admin-portel/static/is/app.24361ale-j9:141:4139)
at newt (nttpst//statickerryprops.com.en/kip/kip-admin-portal/static/js/app.496181a.45/141/225355
at Function.t, createPkceNotGeneratedError (https://static.kerryprops.com.cn/kip/kip-admin-pontal/static/is/app.24961ala.js:141:22692)
at e-sanonymous&amp;gt;/(https://static.kerryprops.com.cn/kip/kip-admin-portal/
&lt;/code>&lt;/pre>&lt;p>原因：
用户没有使用https链接登录S端。使用 &lt;a href="https://admin.kerryplus.com">https://admin.kerryplus.com&lt;/a> 访问登录成功。&lt;/p>
&lt;h3 id="错误2">错误2&lt;/h3>
&lt;p>&lt;a href="https://learn.microsoft.com/en-us/answers/questions/1194524/how-to-fix-aadsts9002325-proof-key-for-code-exchan">How to fix AADSTS9002325: Proof Key for Code Exchange is required for cross-origin authorization code redemption error in msal react application. - Microsoft Q&amp;amp;A&lt;/a>&lt;/p>
&lt;h2 id="参考链接">参考链接&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://devblogs.microsoft.com/azure-sdk/vue-js-user-authentication/">Vue.js User Authentication and the new Azure SDKs - Azure SDK Blog&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications">Initialize MSAL.js client apps - Microsoft identity platform | Microsoft Docs&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/scenario-spa-sign-in?tabs=javascript2">Single-page app sign-in &amp;amp; sign-out - Microsoft identity platform | Microsoft Docs&lt;/a>&lt;/li>
&lt;/ul>
- https://joelz.github.io/tech-blog/posts/20211208-vue_azure_ad_sso/ - Copy, right? 🤔</description></item><item><title>uni-app 多端项目接入阿里云 ARMS</title><link>https://joelz.github.io/tech-blog/posts/20211105-aliyun_arms/</link><pubDate>Fri, 05 Nov 2021 12:01:58 +0800</pubDate><guid>https://joelz.github.io/tech-blog/posts/20211105-aliyun_arms/</guid><description>Notes by Joel https://joelz.github.io/tech-blog/posts/20211105-aliyun_arms/ -&lt;h2 id="官方文档">官方文档&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://help.aliyun.com/document_detail/137303.html">App监控概述&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://help.aliyun.com/document_detail/170905.html">前端监控文档导读&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://help.aliyun.com/document_detail/58652.html">什么是ARMS前端监控？&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="vue项目如何引入">vue项目如何引入&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://www.npmjs.com/package/alife-logger">alife-logger - npm&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/FrankKai/FrankKai.github.io/issues/102">如何引入阿里云ARMS前端监控？ · Issue #102 · FrankKai/FrankKai.github.io · GitHub&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/rochzp/vue-arms">GitHub - rochzp/vue-arms: 基于阿里ARMS的Vue插件&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="uniapp如何引入">uniapp如何引入&lt;/h2>
&lt;ol>
&lt;li>H5：同vue项目处理方式。&lt;/li>
&lt;li>小程序：小程序方式。&lt;/li>
&lt;li>app：和小程序处理方式一致。然后request那里是无法自动上报的，要手动上报。&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>&lt;a href="https://coding.m.imooc.com/questiondetail?cid=433&amp;amp;qid=223708">uniapp开发的微信小程序可以集成阿里云arms前端监控吗&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://sushome.us/front-end/304/303/">Taro(mpvue/uniapp)引入Arms阿里前端监控 - Sushome&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://help.aliyun.com/document_detail/103992.html?spm=a2c4g.11186623.6.614.5ca47408b0MdQN">开始监控微信小程序&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://juejin.cn/post/6996623986889064456">webfunny前端监控平台新增功能教程：获取小程序、uni-app探针安装 - 掘金&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/qq_44706619/article/details/115321552">(9条消息) 原生h5添加阿里云ARMS前端监控__小郑有点困了的博客-CSDN博客&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://uniapp.dcloud.io/collocation/frame/lifecycle?id=%e9%a1%b5%e9%9d%a2%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f">生命周期 - uni-app官网&lt;/a>&lt;/li>
&lt;/ul>
- https://joelz.github.io/tech-blog/posts/20211105-aliyun_arms/ - Copy, right? 🤔</description></item><item><title>App 持续集成</title><link>https://joelz.github.io/tech-blog/posts/20211026-app_ci/</link><pubDate>Tue, 26 Oct 2021 12:01:58 +0800</pubDate><guid>https://joelz.github.io/tech-blog/posts/20211026-app_ci/</guid><description>Notes by Joel https://joelz.github.io/tech-blog/posts/20211026-app_ci/ -&lt;h2 id="android-build-from-command-line">Android: build from command line&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://developer.android.com/studio/build/building-cmdline">从命令行构建您的应用  |  Android 开发者  |  Android Developers&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://stackoverflow.com/questions/24398041/build-android-studio-app-via-command-line">gradle - Build Android Studio app via command line - Stack Overflow&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://newbedev.com/android-studio-how-to-generate-signed-apk-using-gradle">Android Studio: how to generate signed apk using Gradle? | Newbedev&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.tanelikorri.com/tutorial/android/set-apk-filename-in-gradle/">Set Android apk filename in Gradle · Taneli Korri&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://stackoverflow.com/questions/39760172/you-have-not-accepted-the-license-agreements-of-the-following-sdk-components">android - You have not accepted the license agreements of the following SDK components - Stack Overflow&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="ios-build-from-command-line">iOS: build from command line&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://blog.twitch.tv/en/2016/09/20/ios-versioning-89e02f0a5146/">iOS versioning | Twitch Blog&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/forums/thread/70326">how to generate the .ipa from the … | Apple Developer Forums&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/library/archive/technotes/tn2339/_index.html">Technical Note TN2339: Building from the Command Line with Xcode FAQ&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://stackoverflow.com/questions/2664885/xcode-build-and-archive-from-command-line">Xcode &amp;ldquo;Build and Archive&amp;rdquo; from command line - Stack Overflow&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.jianshu.com/p/3a0f965b807b">xcode 命令行 archive,生成ipa包 - 简书&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.cnblogs.com/kaerxifa/p/11132299.html">MAC使用命令行打包出ipa包-通过xcodeproj - wangju003 - 博客园&lt;/a>:&lt;/li>
&lt;/ul>
&lt;blockquote>
&lt;p>其中关键就是exportOptionsPlist 文件需要在之前通过xcode打包导出ipa时的文件夹中去copy一个出来放在当前工程目录中，然后将其拖入-exportOptionsPlist 后面即可。&lt;/p>
&lt;/blockquote>
&lt;h2 id="xcode上传ipa时卡在authenticating-with-app-store">xcode上传ipa时卡在Authenticating with App Store&lt;/h2>
&lt;p>试了很多方法，最后用 xcrun altool 上传成功。后来就再都没用过xcode上传来，都是命令行上传。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://juejin.cn/post/6844904067609657351">iOS 解决应用上传中 Authenticating with the App Store 问题 - 掘金&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.jianshu.com/p/9af59e3ee74b">xcode11 Authenticating with the app store - 简书&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://stackoverflow.com/questions/64202219/xcode-12-stuck-at-authenticating-with-app-store-there-is-no-application-loade">ios - Xcode 12 stuck at &amp;ldquo;Authenticating with App Store&amp;rdquo; (There is no Application Loader anymore) - Stack Overflow&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://stackoverflow.com/questions/22443425/application-loader-stuck-at-authenticating-with-the-itunes-store-when-uploadin/64373421#64373421">xcode - Application Loader stuck at &amp;ldquo;Authenticating with the iTunes store&amp;rdquo; when uploading an iOS app - Stack Overflow&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://help.apple.com/app-store-connect/#/devb1c185036">上传工具 - App Store Connect 帮助&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="app更新">app更新&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://www.jianshu.com/p/95083db83ea1">uniapp的更新与强制更新 - 简书&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/article/34972">uni-app 整包升级/更新方案 - DCloud问答&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/article/35667">uni-app 资源在线升级/热更新 - DCloud问答&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/weixin_37624974/article/details/113735458">(9条消息) uniapp-app更新(去浏览器强制更新，和热更新)_zhangXiaoWei001的博客-CSDN博客_uni-app强制更新&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/question/55915">app如何强制自动升级更新（付费） - DCloud问答&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/article/id-34972__page-5">uni-app 整包升级/更新方案 - DCloud问答&lt;/a>&lt;/li>
&lt;li>&lt;a href="http://www.woshipm.com/pd/646452.html">APP升级二三事：APP升级场景及功能设计总结 | 人人都是产品经理&lt;/a>&lt;/li>
&lt;/ul>
- https://joelz.github.io/tech-blog/posts/20211026-app_ci/ - Copy, right? 🤔</description></item><item><title>iOS上面的验证码自动填充功能</title><link>https://joelz.github.io/tech-blog/posts/20211025-ios_sms_code_autofill/</link><pubDate>Mon, 25 Oct 2021 12:01:58 +0800</pubDate><guid>https://joelz.github.io/tech-blog/posts/20211025-ios_sms_code_autofill/</guid><description>Notes by Joel https://joelz.github.io/tech-blog/posts/20211025-ios_sms_code_autofill/ -&lt;p>测试页面在这里：&lt;a href="https://stackblitz.com/edit/b5a3c-html5-css3?file=input.html">Demo&lt;/a>&lt;/p>
&lt;h2 id="结论">结论&lt;/h2>
&lt;ol>
&lt;li>只有iOS上才有验证码自动填充功能吗？对。&lt;/li>
&lt;li>在iOS上，只有纯数字验证码才能自动填充，数字字母验证码没法自动填充？对。&lt;/li>
&lt;li>在iOS上，非Safari浏览器上，自动填充会填写两次？&lt;a href="https://www.seasidecrab.com/Web/742.html">H5 页面在 IOS 上短信验证码点击一次会自动填充两次 bug 解决 - 海滨擎蟹&lt;/a>&lt;/li>
&lt;li>修改自动填充后input的样式：&lt;a href="https://css-tricks.com/snippets/css/change-autocomplete-styles-webkit-browsers/">Change Autocomplete Styles in WebKit Browsers | CSS-Tricks&lt;/a> 注意字体样式要根据各个输入框去调整&lt;/li>
&lt;li>验证码输入控件处理：不会触发paste事件，触发的事keyup和input事件&lt;/li>
&lt;/ol>
&lt;p>android手机上的自动填充？和QA的对话：&lt;/p>
&lt;blockquote>
&lt;p>对于android系统，目前不会有这个东西。大部分android手机，都是会在屏幕顶部的区域出现短信的提示，短信提示中会有一个复制按钮，点这个复制按钮验证码被复制到剪贴板，然后到输入框中粘贴。我找用android机的同事问了一圈，目前荣耀、一加、小米都是这个行为。现在这个四个格子的验证码输入控件也是支持粘贴的，你可以再测试一下。&lt;/p>
&lt;/blockquote>
&lt;h2 id="验证码输入组件在android机上有问题">验证码输入组件在android机上有问题&lt;/h2>
&lt;p>最早是用一加6发现keycode一直为0，后面做了调整：&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://stackoverflow.com/questions/17139039/keycode-is-always-zero-in-chrome-for-android">javascript - Keycode is always zero in Chrome for Android - Stack Overflow&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/code">KeyboardEvent.code - Web APIs | MDN&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://api.jquery.com/event.which/">event.which | jQuery API Documentation&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>后来QA报bug，说在华为和荣耀上验证码输入控价都无法使用，因为keyCode完全不对：&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://stackoverflow.com/questions/36753548/keycode-on-android-is-always-229">javascript - keyCode on android is always 229 - Stack Overflow&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/brilliantSt/article/details/115381443">(9条消息) 中文输入法时获取e.keycode一直为229_brilliantSt的博客-CSDN博客&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/qq_45327292/article/details/103274456?spm=1001.2101.3001.6650.5&amp;amp;utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EOPENSEARCH%7Edefault-5.essearch_pc_relevant&amp;amp;depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EOPENSEARCH%7Edefault-5.essearch_pc_relevant">(9条消息) 解决安卓端拿不到软键盘真实keycode值，全为229。_所有热爱的东西都要不余遗力-CSDN博客&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/this_ITBoy/article/details/100089299?utm_medium=distribute.pc_relevant.none-task-blog-2~default~baidujs_title~default-0.essearch_pc_relevant&amp;amp;spm=1001.2101.3001.4242.1">(9条消息) 移动端H5页面关于软键盘的一些踩坑记录_this_ITBoy的博客-CSDN博客&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>最后没办法，只能改为在android机器上就不显示验证码输入控件，用一个普通文本框来替代。&lt;/p>
&lt;h2 id="links">links&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://juejin.cn/post/7001860958461100040">用起来像 UITextField 一样的自定义验证码输入框 - 掘金&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://kemchenj.github.io/2019-04-07/">记一次验证码输入框的实现 | kemchenj&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/u010214074/article/details/116313002">(3条消息) h5短信验证码复制/自动填充等问题_阿之阿佐-CSDN博客&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://medium.com/@lamalamaMark/one-time-security-code-in-ios-safari-27869e16085f">One Time Security Code in iOS Safari | by Mark de Vries | Medium&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://juejin.cn/post/6844903919404089357">ios h5 验证码填充 - 掘金&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.csdn.net/xiaolinlife/article/details/90477430">(5条消息) 项目总结之ios手机中input框中粘贴短信验证码keyup事件无效_时清云的博客-CSDN博客&lt;/a>&lt;/li>
&lt;/ul>
- https://joelz.github.io/tech-blog/posts/20211025-ios_sms_code_autofill/ - Copy, right? 🤔</description></item><item><title>App CPU 架构是 x86 还是 x64？</title><link>https://joelz.github.io/tech-blog/posts/20210910-app_arch_x86_x64/</link><pubDate>Fri, 10 Sep 2021 12:01:58 +0800</pubDate><guid>https://joelz.github.io/tech-blog/posts/20210910-app_arch_x86_x64/</guid><description>Notes by Joel https://joelz.github.io/tech-blog/posts/20210910-app_arch_x86_x64/ -&lt;p>Android app 上架应用商店时被问到 app 是 32 位还是 64 位的。所以有了这一片辨析。&lt;/p>
&lt;h2 id="ios64位">iOS：64位&lt;/h2>
&lt;blockquote>
&lt;p>In iOS 11 and later, all apps use the 64-bit architecture. If your app targets an earlier version of iOS, you must update it to run on later versions.&lt;/p>
&lt;/blockquote>
&lt;h2 id="android32位64位">Android：32位+64位&lt;/h2>
&lt;p>ABI是英文Application Binary Interface的缩写，及应用二进制接口。&lt;/p>
&lt;h3 id="android-主要的abis">Android 主要的ABIs:&lt;/h3>
&lt;p>32位：&lt;/p>
&lt;ul>
&lt;li>X86&lt;/li>
&lt;li>armeabi&lt;/li>
&lt;li>armeabi-v7a&lt;/li>
&lt;/ul>
&lt;p>64位：&lt;/p>
&lt;ul>
&lt;li>X86–64,&lt;/li>
&lt;li>arm64-v8a,&lt;/li>
&lt;/ul>
&lt;h3 id="android-7种cpu架构在当前市场的占有率">Android 7种CPU架构在当前市场的占有率&lt;/h3>
&lt;ul>
&lt;li>&lt;code>arm64-v8a&lt;/code>: 目前主流版本&lt;/li>
&lt;li>&lt;code>armeabi-v7a&lt;/code>: 一些老旧的手机&lt;/li>
&lt;li>&lt;code>x86 / x86_64&lt;/code>: x86 架构的手机都会包含由 Intel 提供的称为 Houdini 的指令集动态转码工具，实现对 arm .so 的兼容，再考虑 x86 1% 以下的市场占有率，x86 相关的两个 .so 也是可以忽略的&lt;/li>
&lt;li>&lt;code>armeabi/mips / mips64&lt;/code>: NDK 以前支持 ARMv5 (armeabi) 以及 32 位和 64 位 MIPS，但 NDK r17 已不再支持，极少用于手机可以忽。&lt;/li>
&lt;/ul>
&lt;h3 id="适配规则">适配规则：&lt;/h3>
&lt;p>&lt;strong>一个Android设备可以支持多种ABI&lt;/strong>,设备主ABI和辅助ABI,以arm64-v8a为主ABI的设备，辅助ABI为armeabi-v7a和armeabi，以armeabi-v7a为主ABI的设备，辅助ABI为armeabi。&lt;/p>
&lt;ul>
&lt;li>只适配armeabi的APP可以跑在armeabi,x86,x86_64,armeabi-v7a,arm64-v8上&lt;/li>
&lt;li>只适配armeabi-v7a可以运行在armeabi-v7a和arm64-v8a&lt;/li>
&lt;li>只适配arm64-v8a 可以运行在arm64-v8a上&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>一个app可以选择多个ABI&lt;/strong>&lt;/p>
&lt;h3 id="主流app的abi-适配情况">主流App的ABI 适配情况&lt;/h3>
&lt;p>微信适配的是arm64-v8a(微信应该是最近才适配到arm64-v8a,以前是armeabi), 支付宝和手Q适配的是armeabi，淘宝适配的是armeabi-v7a。各个APP适配的平台不太一样，但是他们有一个共同点，那就是它们只指定了一个平台。&lt;/p>
&lt;p>&lt;a href="https://juejin.cn/post/6844904148589084680">为何大厂APP如微信、支付宝、淘宝、手Q等只适配了armeabi-v7a/armeabi？ - 掘金&lt;/a>&lt;/p>
&lt;h3 id="uniapp离线打包仅支持arm64-v8aarmeabi-v7ax86三种类型">UNIAPP离线打包仅支持arm64-v8a、armeabi-v7a、x86三种类型，&lt;/h3>
&lt;p>建议根据自己需求选择打包的CPU类型。&lt;strong>支持ABI越多，包体积越大。&lt;/strong>&lt;/p>
&lt;p>方案1: 只选 arm64-v8a （64位）
方案2: 只选 armeabi-v7a （32位）
&lt;strong>方案3: arm64-v8a + armeabi-v7a （64位和32位 都支持）&lt;/strong>&lt;/p>
&lt;h2 id="links">links&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="http://ipv6-test.com/validate.php">IPv6 test - web site reachability&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/documentation/uikit/app_and_environment/updating_your_app_from_32-bit_to_64-bit_architecture">Updating Your App from 32-Bit to 64-Bit Architecture | Apple Developer Documentation&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/support/app-store">App Store - Support - Apple Developer&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://mixpanel.com/trends/">Mixpanel Trends - Mixpanel | Product Analytics&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://juejin.cn/post/6844904148589084680">为何大厂APP如微信、支付宝、淘宝、手Q等只适配了armeabi-v7a/armeabi？ - 掘金&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.android.com/ndk/guides/abis?hl=zh-cn#android-platform-abi-support">Android ABI | Android NDK | Android Developers&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://ask.dcloud.net.cn/article/36195">Android平台App支持CPU类型配置说明 - DCloud问答&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://cloud.tencent.com/developer/article/1169072">解决苹果app上线需要支持ipv6的问题 - 云+社区 - 腾讯云&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.google.com/search?q=app+support+ipv6&amp;amp;newwindow=1&amp;amp;ei=Ju06YeeEO9fP0PEPgJm2-A4&amp;amp;oq=app+support+ipv6&amp;amp;gs_lcp=Cgdnd3Mtd2l6EAMyBggAEAUQHjIGCAAQCBAeMgYIABAIEB4yBggAEAgQHjoHCAAQRxCwAzoGCAAQBxAeOgQIABBDOgQIABAeSgUIPBIBMUoECEEYAVDL7FNY3v1TYI6DVGgBcAB4AYABjgOIAcIUkgEFMi03LjKYAQCgAQHIAQrAAQE&amp;amp;sclient=gws-wiz&amp;amp;ved=0ahUKEwjnr5-p1vPyAhXXJzQIHYCMDe8Q4dUDCA4&amp;amp;uact=5">app support ipv6 - Google 搜索&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://blog.cdemi.io/how-software-engineers-can-make-their-apps-ipv6-ready/">How Software Engineers can make their apps IPv6 Ready&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.apple.com/cn/support/ipv6/">支持纯 IPv6 网络 - 支持 - Apple Developer&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://developer.aliyun.com/article/115929">如何确保你的 APP 支持 IPv6-阿里云开发者社区&lt;/a>&lt;/li>
&lt;/ul>
- https://joelz.github.io/tech-blog/posts/20210910-app_arch_x86_x64/ - Copy, right? 🤔</description></item></channel></rss>